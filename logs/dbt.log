[0m15:04:40.045596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb06f4c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb09484b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb094c4a30>]}


============================== 15:04:40.053206 | 2c2fb0e6-8c82-401c-809b-385ad941c496 ==============================
[0m15:04:40.053206 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:04:40.054586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:04:40.055672 [info ] [MainThread]: dbt version: 1.7.11
[0m15:04:40.056342 [info ] [MainThread]: python version: 3.9.13
[0m15:04:40.056968 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m15:04:40.057591 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m15:04:40.221945 [info ] [MainThread]: Using profiles dir at /Users/amal/.dbt
[0m15:04:40.222682 [info ] [MainThread]: Using profiles.yml file at /Users/amal/.dbt/profiles.yml
[0m15:04:40.223337 [info ] [MainThread]: Using dbt_project.yml file at /Users/amal/Desktop/dbt/data_engineering/dbt_test/dbt_project.yml
[0m15:04:40.225891 [info ] [MainThread]: adapter type: postgres
[0m15:04:40.226782 [info ] [MainThread]: adapter version: 1.7.11
[0m15:04:40.334663 [info ] [MainThread]: Configuration:
[0m15:04:40.335495 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:04:40.336152 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:04:40.336879 [info ] [MainThread]: Required dependencies:
[0m15:04:40.337613 [debug] [MainThread]: Executing "git --help"
[0m15:04:40.349441 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:04:40.350871 [debug] [MainThread]: STDERR: "b''"
[0m15:04:40.351650 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:04:40.352763 [info ] [MainThread]: Connection:
[0m15:04:40.353983 [info ] [MainThread]:   host: localhost
[0m15:04:40.355064 [info ] [MainThread]:   port: 5432
[0m15:04:40.356262 [info ] [MainThread]:   user: amal
[0m15:04:40.356963 [info ] [MainThread]:   database: dbt_db
[0m15:04:40.357873 [info ] [MainThread]:   schema: public
[0m15:04:40.358723 [info ] [MainThread]:   connect_timeout: 10
[0m15:04:40.359688 [info ] [MainThread]:   role: None
[0m15:04:40.360575 [info ] [MainThread]:   search_path: None
[0m15:04:40.361316 [info ] [MainThread]:   keepalives_idle: 0
[0m15:04:40.361924 [info ] [MainThread]:   sslmode: None
[0m15:04:40.362696 [info ] [MainThread]:   sslcert: None
[0m15:04:40.363633 [info ] [MainThread]:   sslkey: None
[0m15:04:40.364328 [info ] [MainThread]:   sslrootcert: None
[0m15:04:40.365068 [info ] [MainThread]:   application_name: dbt
[0m15:04:40.365693 [info ] [MainThread]:   retries: 1
[0m15:04:40.366585 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m15:04:40.374867 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:04:40.376937 [debug] [MainThread]: Using postgres connection "debug"
[0m15:04:40.377972 [debug] [MainThread]: On debug: select 1 as id
[0m15:04:40.378838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:40.480576 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:04:40.483234 [debug] [MainThread]: On debug: Close
[0m15:04:40.483978 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:04:40.484690 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:04:40.487890 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.5233385, "process_user_time": 3.046918, "process_kernel_time": 0.503045, "process_mem_max_rss": "95768576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:04:40.489114 [debug] [MainThread]: Command `dbt debug` succeeded at 15:04:40.488858 after 0.52 seconds
[0m15:04:40.489853 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:04:40.490610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb06f4c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb0946dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb09552400>]}
[0m15:04:40.491435 [debug] [MainThread]: Flushing usage events
[0m15:30:22.925617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1776ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1946e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf194c5760>]}


============================== 15:30:22.933864 | f2cfaa37-8390-4c34-96ef-09f72942544b ==============================
[0m15:30:22.933864 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:30:22.934915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amal/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:30:22.935969 [info ] [MainThread]: dbt version: 1.7.11
[0m15:30:22.936618 [info ] [MainThread]: python version: 3.9.13
[0m15:30:22.937237 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m15:30:22.937849 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m15:30:23.100541 [info ] [MainThread]: Using profiles dir at /Users/amal/.dbt
[0m15:30:23.101702 [info ] [MainThread]: Using profiles.yml file at /Users/amal/.dbt/profiles.yml
[0m15:30:23.102494 [info ] [MainThread]: Using dbt_project.yml file at /Users/amal/Desktop/dbt/data_engineering/dbt_test/dbt_project.yml
[0m15:30:23.103784 [info ] [MainThread]: adapter type: postgres
[0m15:30:23.104502 [info ] [MainThread]: adapter version: 1.7.11
[0m15:30:23.211179 [info ] [MainThread]: Configuration:
[0m15:30:23.212009 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:30:23.212651 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:30:23.213169 [info ] [MainThread]: Required dependencies:
[0m15:30:23.213768 [debug] [MainThread]: Executing "git --help"
[0m15:30:23.229967 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:30:23.231307 [debug] [MainThread]: STDERR: "b''"
[0m15:30:23.232184 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:30:23.233327 [info ] [MainThread]: Connection:
[0m15:30:23.234554 [info ] [MainThread]:   host: localhost
[0m15:30:23.235200 [info ] [MainThread]:   port: 5432
[0m15:30:23.235797 [info ] [MainThread]:   user: amal
[0m15:30:23.236363 [info ] [MainThread]:   database: dbt_db
[0m15:30:23.236923 [info ] [MainThread]:   schema: source
[0m15:30:23.237488 [info ] [MainThread]:   connect_timeout: 10
[0m15:30:23.238100 [info ] [MainThread]:   role: None
[0m15:30:23.239026 [info ] [MainThread]:   search_path: None
[0m15:30:23.240002 [info ] [MainThread]:   keepalives_idle: 0
[0m15:30:23.241172 [info ] [MainThread]:   sslmode: None
[0m15:30:23.241887 [info ] [MainThread]:   sslcert: None
[0m15:30:23.242484 [info ] [MainThread]:   sslkey: None
[0m15:30:23.243164 [info ] [MainThread]:   sslrootcert: None
[0m15:30:23.244451 [info ] [MainThread]:   application_name: dbt
[0m15:30:23.245317 [info ] [MainThread]:   retries: 1
[0m15:30:23.246327 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m15:30:23.254930 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:30:23.257096 [debug] [MainThread]: Using postgres connection "debug"
[0m15:30:23.258413 [debug] [MainThread]: On debug: select 1 as id
[0m15:30:23.259174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:23.314671 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:30:23.317319 [debug] [MainThread]: On debug: Close
[0m15:30:23.318228 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:30:23.319004 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:30:23.322038 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.48348492, "process_user_time": 2.977599, "process_kernel_time": 0.428146, "process_mem_max_rss": "95207424", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:30:23.323248 [debug] [MainThread]: Command `dbt debug` succeeded at 15:30:23.322982 after 0.48 seconds
[0m15:30:23.323986 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:30:23.324761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1776ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf194ab670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf19669b50>]}
[0m15:30:23.325853 [debug] [MainThread]: Flushing usage events
[0m21:29:18.570487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32872d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32a37d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32a3a6220>]}


============================== 21:29:18.576715 | 335513ff-fbad-4f8e-b5cf-1d64d2af880d ==============================
[0m21:29:18.576715 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:29:18.577711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amal/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:29:19.372799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '335513ff-fbad-4f8e-b5cf-1d64d2af880d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe329092f40>]}
[0m21:29:19.480134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '335513ff-fbad-4f8e-b5cf-1d64d2af880d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32a79da30>]}
[0m21:29:19.487212 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:29:19.517672 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:29:19.519204 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:29:19.520171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '335513ff-fbad-4f8e-b5cf-1d64d2af880d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32a8b17f0>]}
[0m21:29:20.826433 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m21:29:20.950985 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m21:29:20.951915 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_test.not_null_my_second_dbt_model_id.151b76d778' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m21:29:21.001638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '335513ff-fbad-4f8e-b5cf-1d64d2af880d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32acf30d0>]}
[0m21:29:21.022163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '335513ff-fbad-4f8e-b5cf-1d64d2af880d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32a8c3160>]}
[0m21:29:21.022944 [info ] [MainThread]: Found 2 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:29:21.023551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '335513ff-fbad-4f8e-b5cf-1d64d2af880d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32a8b1940>]}
[0m21:29:21.025756 [info ] [MainThread]: 
[0m21:29:21.027223 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:29:21.029050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m21:29:21.043423 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m21:29:21.044168 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m21:29:21.045180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:21.114994 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:29:21.116816 [debug] [ThreadPool]: On list_dbt_db: Close
[0m21:29:21.118925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_source)
[0m21:29:21.127253 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_source"
[0m21:29:21.127866 [debug] [ThreadPool]: On list_dbt_db_source: BEGIN
[0m21:29:21.128341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:21.175174 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:29:21.176259 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_source"
[0m21:29:21.177207 [debug] [ThreadPool]: On list_dbt_db_source: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_source"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'source'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'source'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'source'
  
[0m21:29:21.191855 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:29:21.194130 [debug] [ThreadPool]: On list_dbt_db_source: ROLLBACK
[0m21:29:21.194923 [debug] [ThreadPool]: On list_dbt_db_source: Close
[0m21:29:21.202309 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:21.203028 [debug] [MainThread]: On master: BEGIN
[0m21:29:21.203631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:21.209866 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:29:21.210537 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:21.211230 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:29:21.228080 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:29:21.229916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '335513ff-fbad-4f8e-b5cf-1d64d2af880d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32af5d7f0>]}
[0m21:29:21.230650 [debug] [MainThread]: On master: ROLLBACK
[0m21:29:21.231324 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:21.231838 [debug] [MainThread]: On master: BEGIN
[0m21:29:21.232548 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:29:21.233069 [debug] [MainThread]: On master: COMMIT
[0m21:29:21.233577 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:21.234070 [debug] [MainThread]: On master: COMMIT
[0m21:29:21.234685 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:29:21.235203 [debug] [MainThread]: On master: Close
[0m21:29:21.236141 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:29:21.236822 [info ] [MainThread]: 
[0m21:29:21.242673 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m21:29:21.243509 [debug] [Thread-2  ]: Began running node model.dbt_test.users_model
[0m21:29:21.244528 [info ] [Thread-1  ]: 1 of 2 START sql table model source.my_first_dbt_model ......................... [RUN]
[0m21:29:21.245740 [info ] [Thread-2  ]: 2 of 2 START sql view model source.users_model ................................. [RUN]
[0m21:29:21.246916 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_source, now model.dbt_test.my_first_dbt_model)
[0m21:29:21.247933 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.dbt_test.users_model'
[0m21:29:21.248698 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:29:21.249403 [debug] [Thread-2  ]: Began compiling node model.dbt_test.users_model
[0m21:29:21.263255 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:29:21.266910 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_test.users_model"
[0m21:29:21.268717 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (compile): 21:29:21.263939 => 21:29:21.268161
[0m21:29:21.269652 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (compile): 21:29:21.249809 => 21:29:21.269183
[0m21:29:21.270249 [debug] [Thread-2  ]: Began executing node model.dbt_test.users_model
[0m21:29:21.270809 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:29:21.347221 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_test.users_model"
[0m21:29:21.351225 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:29:21.352546 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:29:21.353159 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:29:21.353902 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:29:21.354879 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:29:21.355593 [debug] [Thread-2  ]: On model.dbt_test.users_model: BEGIN
[0m21:29:21.356678 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:29:21.363480 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:29:21.364672 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:29:21.365639 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m21:29:21.366671 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_db"."source"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:29:21.367487 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:29:21.368537 [debug] [Thread-2  ]: On model.dbt_test.users_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users_model"} */

  create view "dbt_db"."source"."users_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select id, user_name from users
  );
[0m21:29:21.453570 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 9: select id, user_name from users
                                  ^

[0m21:29:21.454922 [debug] [Thread-2  ]: On model.dbt_test.users_model: ROLLBACK
[0m21:29:21.456538 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (execute): 21:29:21.271169 => 21:29:21.455998
[0m21:29:21.457404 [debug] [Thread-2  ]: On model.dbt_test.users_model: Close
[0m21:29:21.472521 [debug] [Thread-2  ]: Database Error in model users_model (models/example/users_model.sql)
  relation "users" does not exist
  LINE 9: select id, user_name from users
                                    ^
  compiled Code at target/run/dbt_test/models/example/users_model.sql
[0m21:29:21.473497 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '335513ff-fbad-4f8e-b5cf-1d64d2af880d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32adae7c0>]}
[0m21:29:21.474509 [error] [Thread-2  ]: 2 of 2 ERROR creating sql view model source.users_model ........................ [[31mERROR[0m in 0.23s]
[0m21:29:21.475555 [debug] [Thread-2  ]: Finished running node model.dbt_test.users_model
[0m21:29:21.539322 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m21:29:21.550654 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:29:21.551493 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."source"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:29:21.552808 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:29:21.579166 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:29:21.580051 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:29:21.580702 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:29:21.582605 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:29:21.591482 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."source"."my_first_dbt_model__dbt_backup"
[0m21:29:21.597384 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:29:21.598047 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_db"."source"."my_first_dbt_model__dbt_backup" cascade
[0m21:29:21.598924 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:29:21.601283 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (execute): 21:29:21.289981 => 21:29:21.600882
[0m21:29:21.602028 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: Close
[0m21:29:21.603268 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '335513ff-fbad-4f8e-b5cf-1d64d2af880d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32add5d60>]}
[0m21:29:21.604614 [info ] [Thread-1  ]: 1 of 2 OK created sql table model source.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.36s]
[0m21:29:21.605762 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:29:21.608222 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:21.608940 [debug] [MainThread]: On master: BEGIN
[0m21:29:21.609505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:21.616111 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:29:21.617000 [debug] [MainThread]: On master: COMMIT
[0m21:29:21.617867 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:21.618508 [debug] [MainThread]: On master: COMMIT
[0m21:29:21.619280 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:29:21.619902 [debug] [MainThread]: On master: Close
[0m21:29:21.620977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:21.621640 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m21:29:21.622428 [debug] [MainThread]: Connection 'model.dbt_test.users_model' was properly closed.
[0m21:29:21.623154 [info ] [MainThread]: 
[0m21:29:21.623910 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m21:29:21.625311 [debug] [MainThread]: Command end result
[0m21:29:21.639965 [info ] [MainThread]: 
[0m21:29:21.640839 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:29:21.642043 [info ] [MainThread]: 
[0m21:29:21.643247 [error] [MainThread]:   Database Error in model users_model (models/example/users_model.sql)
  relation "users" does not exist
  LINE 9: select id, user_name from users
                                    ^
  compiled Code at target/run/dbt_test/models/example/users_model.sql
[0m21:29:21.644759 [info ] [MainThread]: 
[0m21:29:21.646479 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:29:21.650004 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.1670225, "process_user_time": 4.815862, "process_kernel_time": 0.843658, "process_mem_max_rss": "110620672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:29:21.651083 [debug] [MainThread]: Command `dbt run` failed at 21:29:21.650841 after 3.17 seconds
[0m21:29:21.651825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32872d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32a762070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32af0f070>]}
[0m21:29:21.652632 [debug] [MainThread]: Flushing usage events
[0m21:30:56.138123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38776abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb389346b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb389385a30>]}


============================== 21:30:56.142664 | a115178e-5b77-4007-a668-ef98f2f9f1fc ==============================
[0m21:30:56.142664 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:30:56.143569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'profiles_dir': '/Users/amal/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:30:56.144356 [info ] [MainThread]: dbt version: 1.7.11
[0m21:30:56.144926 [info ] [MainThread]: python version: 3.9.13
[0m21:30:56.145778 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m21:30:56.146468 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m21:30:56.262552 [info ] [MainThread]: Using profiles dir at /Users/amal/.dbt
[0m21:30:56.263439 [info ] [MainThread]: Using profiles.yml file at /Users/amal/.dbt/profiles.yml
[0m21:30:56.264371 [info ] [MainThread]: Using dbt_project.yml file at /Users/amal/Desktop/dbt/data_engineering/dbt_test/dbt_project.yml
[0m21:30:56.265232 [info ] [MainThread]: adapter type: postgres
[0m21:30:56.265870 [info ] [MainThread]: adapter version: 1.7.11
[0m21:30:56.374134 [info ] [MainThread]: Configuration:
[0m21:30:56.374949 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:30:56.375552 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:30:56.376161 [info ] [MainThread]: Required dependencies:
[0m21:30:56.376845 [debug] [MainThread]: Executing "git --help"
[0m21:30:56.388637 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:30:56.389829 [debug] [MainThread]: STDERR: "b''"
[0m21:30:56.390791 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:30:56.391570 [info ] [MainThread]: Connection:
[0m21:30:56.392592 [info ] [MainThread]:   host: localhost
[0m21:30:56.393526 [info ] [MainThread]:   port: 5432
[0m21:30:56.394436 [info ] [MainThread]:   user: amal
[0m21:30:56.396104 [info ] [MainThread]:   database: dbt_db
[0m21:30:56.397170 [info ] [MainThread]:   schema: public
[0m21:30:56.398114 [info ] [MainThread]:   connect_timeout: 10
[0m21:30:56.398719 [info ] [MainThread]:   role: None
[0m21:30:56.399273 [info ] [MainThread]:   search_path: None
[0m21:30:56.399825 [info ] [MainThread]:   keepalives_idle: 0
[0m21:30:56.400379 [info ] [MainThread]:   sslmode: None
[0m21:30:56.400946 [info ] [MainThread]:   sslcert: None
[0m21:30:56.401564 [info ] [MainThread]:   sslkey: None
[0m21:30:56.402921 [info ] [MainThread]:   sslrootcert: None
[0m21:30:56.404247 [info ] [MainThread]:   application_name: dbt
[0m21:30:56.404906 [info ] [MainThread]:   retries: 1
[0m21:30:56.406641 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:30:56.416396 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:30:56.419879 [debug] [MainThread]: Using postgres connection "debug"
[0m21:30:56.420831 [debug] [MainThread]: On debug: select 1 as id
[0m21:30:56.422041 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:56.497596 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:30:56.501747 [debug] [MainThread]: On debug: Close
[0m21:30:56.503201 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:30:56.507022 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:30:56.515451 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.44306844, "process_user_time": 2.624416, "process_kernel_time": 0.254122, "process_mem_max_rss": "94662656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:30:56.518080 [debug] [MainThread]: Command `dbt debug` succeeded at 21:30:56.517630 after 0.45 seconds
[0m21:30:56.519186 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:30:56.520229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38776abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3895f89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3896a38e0>]}
[0m21:30:56.521722 [debug] [MainThread]: Flushing usage events
[0m21:31:04.601627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a4f3d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a6c9cd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a6cc6d30>]}


============================== 21:31:04.606180 | 9bf9933a-d6ca-49de-9b55-82feddb07a5a ==============================
[0m21:31:04.606180 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:31:04.607070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/amal/.dbt', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:31:04.870185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bf9933a-d6ca-49de-9b55-82feddb07a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a6c87e50>]}
[0m21:31:04.975527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bf9933a-d6ca-49de-9b55-82feddb07a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a6e3d850>]}
[0m21:31:04.976540 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:31:04.998694 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:31:05.019137 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:31:05.019961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9bf9933a-d6ca-49de-9b55-82feddb07a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a6f93940>]}
[0m21:31:06.180278 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m21:31:06.309934 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m21:31:06.310831 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_test.not_null_my_second_dbt_model_id.151b76d778' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m21:31:06.369019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bf9933a-d6ca-49de-9b55-82feddb07a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a7682eb0>]}
[0m21:31:06.390606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bf9933a-d6ca-49de-9b55-82feddb07a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a710cc70>]}
[0m21:31:06.391384 [info ] [MainThread]: Found 2 models, 2 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:31:06.391990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bf9933a-d6ca-49de-9b55-82feddb07a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a721ce20>]}
[0m21:31:06.393944 [info ] [MainThread]: 
[0m21:31:06.395087 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:31:06.396576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m21:31:06.414964 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m21:31:06.415757 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m21:31:06.416361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:06.438336 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:31:06.440289 [debug] [ThreadPool]: On list_dbt_db: Close
[0m21:31:06.442660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m21:31:06.451717 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:31:06.452347 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m21:31:06.452847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:06.458741 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:31:06.459342 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:31:06.459864 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:31:06.463734 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:31:06.465345 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m21:31:06.466034 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m21:31:06.471779 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:06.472372 [debug] [MainThread]: On master: BEGIN
[0m21:31:06.472853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:31:06.478302 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:31:06.478892 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:06.479490 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:31:06.490438 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:31:06.492086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bf9933a-d6ca-49de-9b55-82feddb07a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a78068e0>]}
[0m21:31:06.492748 [debug] [MainThread]: On master: ROLLBACK
[0m21:31:06.493391 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:06.493905 [debug] [MainThread]: On master: BEGIN
[0m21:31:06.494651 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:31:06.495170 [debug] [MainThread]: On master: COMMIT
[0m21:31:06.495676 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:06.496172 [debug] [MainThread]: On master: COMMIT
[0m21:31:06.496852 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:31:06.497406 [debug] [MainThread]: On master: Close
[0m21:31:06.498370 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:31:06.498933 [info ] [MainThread]: 
[0m21:31:06.502300 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m21:31:06.502947 [debug] [Thread-2  ]: Began running node model.dbt_test.users_model
[0m21:31:06.503700 [info ] [Thread-1  ]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m21:31:06.504473 [info ] [Thread-2  ]: 2 of 2 START sql view model public.users_model ................................. [RUN]
[0m21:31:06.505707 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.dbt_test.my_first_dbt_model)
[0m21:31:06.506806 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.dbt_test.users_model'
[0m21:31:06.507500 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:31:06.508086 [debug] [Thread-2  ]: Began compiling node model.dbt_test.users_model
[0m21:31:06.519839 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:31:06.522395 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_test.users_model"
[0m21:31:06.523649 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (compile): 21:31:06.520365 => 21:31:06.523268
[0m21:31:06.524442 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (compile): 21:31:06.508474 => 21:31:06.524083
[0m21:31:06.525008 [debug] [Thread-2  ]: Began executing node model.dbt_test.users_model
[0m21:31:06.525725 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:31:06.606416 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_test.users_model"
[0m21:31:06.614161 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:31:06.615339 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:31:06.615928 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:31:06.616457 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:31:06.617001 [debug] [Thread-2  ]: On model.dbt_test.users_model: BEGIN
[0m21:31:06.617531 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:31:06.618056 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:31:06.625573 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:31:06.626221 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:31:06.626825 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m21:31:06.627431 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:31:06.628003 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:31:06.628730 [debug] [Thread-2  ]: On model.dbt_test.users_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users_model"} */

  create view "dbt_db"."public"."users_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select id, user_name from users
  );
[0m21:31:06.629952 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 9: select id, user_name from users
                                  ^

[0m21:31:06.630705 [debug] [Thread-2  ]: On model.dbt_test.users_model: ROLLBACK
[0m21:31:06.631333 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m21:31:06.638538 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (execute): 21:31:06.526163 => 21:31:06.638202
[0m21:31:06.640052 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:31:06.640816 [debug] [Thread-2  ]: On model.dbt_test.users_model: Close
[0m21:31:06.641387 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:31:06.643702 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:31:06.666666 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:31:06.667349 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:31:06.667878 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:31:06.669610 [debug] [Thread-2  ]: Database Error in model users_model (models/example/users_model.sql)
  relation "users" does not exist
  LINE 9: select id, user_name from users
                                    ^
  compiled Code at target/run/dbt_test/models/example/users_model.sql
[0m21:31:06.670376 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:31:06.670995 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf9933a-d6ca-49de-9b55-82feddb07a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a77bc040>]}
[0m21:31:06.679295 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."my_first_dbt_model__dbt_backup"
[0m21:31:06.680166 [error] [Thread-2  ]: 2 of 2 ERROR creating sql view model public.users_model ........................ [[31mERROR[0m in 0.16s]
[0m21:31:06.686080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:31:06.687244 [debug] [Thread-2  ]: Finished running node model.dbt_test.users_model
[0m21:31:06.688073 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m21:31:06.689516 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:31:06.691838 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (execute): 21:31:06.550093 => 21:31:06.691527
[0m21:31:06.692614 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: Close
[0m21:31:06.695004 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf9933a-d6ca-49de-9b55-82feddb07a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a65b1df0>]}
[0m21:31:06.696945 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.19s]
[0m21:31:06.698409 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:31:06.701087 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:06.701823 [debug] [MainThread]: On master: BEGIN
[0m21:31:06.702379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:31:06.709831 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:31:06.710773 [debug] [MainThread]: On master: COMMIT
[0m21:31:06.711703 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:06.712515 [debug] [MainThread]: On master: COMMIT
[0m21:31:06.713460 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:31:06.714255 [debug] [MainThread]: On master: Close
[0m21:31:06.715411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:06.716152 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m21:31:06.716880 [debug] [MainThread]: Connection 'model.dbt_test.users_model' was properly closed.
[0m21:31:06.717783 [info ] [MainThread]: 
[0m21:31:06.718472 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m21:31:06.720227 [debug] [MainThread]: Command end result
[0m21:31:06.737247 [info ] [MainThread]: 
[0m21:31:06.738493 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:31:06.739410 [info ] [MainThread]: 
[0m21:31:06.740924 [error] [MainThread]:   Database Error in model users_model (models/example/users_model.sql)
  relation "users" does not exist
  LINE 9: select id, user_name from users
                                    ^
  compiled Code at target/run/dbt_test/models/example/users_model.sql
[0m21:31:06.741901 [info ] [MainThread]: 
[0m21:31:06.743150 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:31:06.745953 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2067006, "process_user_time": 4.29584, "process_kernel_time": 0.306411, "process_mem_max_rss": "111022080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:31:06.747158 [debug] [MainThread]: Command `dbt run` failed at 21:31:06.746905 after 2.21 seconds
[0m21:31:06.747902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a4f3d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a74eb220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a71e1160>]}
[0m21:31:06.748621 [debug] [MainThread]: Flushing usage events
[0m21:33:45.218287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fa729b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fc47eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fc4a76a0>]}


============================== 21:33:45.222978 | b2bc57aa-0411-4d73-8295-45913551c30d ==============================
[0m21:33:45.222978 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:33:45.223809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:33:45.504933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2bc57aa-0411-4d73-8295-45913551c30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fc44fb50>]}
[0m21:33:45.615008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2bc57aa-0411-4d73-8295-45913551c30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fc61dd90>]}
[0m21:33:45.616050 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:33:45.638076 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:33:45.693712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:33:45.694770 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/example/schema.yml
[0m21:33:45.960071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2bc57aa-0411-4d73-8295-45913551c30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fccc00d0>]}
[0m21:33:45.978545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2bc57aa-0411-4d73-8295-45913551c30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fca0b5b0>]}
[0m21:33:45.979243 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:33:45.979918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2bc57aa-0411-4d73-8295-45913551c30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fca0b460>]}
[0m21:33:45.982136 [info ] [MainThread]: 
[0m21:33:45.983300 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:33:45.984662 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m21:33:46.001007 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m21:33:46.001727 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m21:33:46.002300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:46.038904 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:33:46.041057 [debug] [ThreadPool]: On list_dbt_db: Close
[0m21:33:46.043336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m21:33:46.052634 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:33:46.053302 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m21:33:46.053815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:46.059879 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:33:46.060512 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:33:46.061050 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:33:46.065057 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:33:46.066767 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m21:33:46.067460 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m21:33:46.073708 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:46.074304 [debug] [MainThread]: On master: BEGIN
[0m21:33:46.074794 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:46.080399 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:33:46.080994 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:46.081601 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:33:46.090665 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:33:46.092330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2bc57aa-0411-4d73-8295-45913551c30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fce2f880>]}
[0m21:33:46.093027 [debug] [MainThread]: On master: ROLLBACK
[0m21:33:46.093680 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:46.094181 [debug] [MainThread]: On master: BEGIN
[0m21:33:46.094905 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:33:46.095427 [debug] [MainThread]: On master: COMMIT
[0m21:33:46.095928 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:46.096411 [debug] [MainThread]: On master: COMMIT
[0m21:33:46.096993 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:33:46.097498 [debug] [MainThread]: On master: Close
[0m21:33:46.098490 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:33:46.099164 [info ] [MainThread]: 
[0m21:33:46.102490 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m21:33:46.103063 [debug] [Thread-2  ]: Began running node model.dbt_test.users_model
[0m21:33:46.103901 [info ] [Thread-1  ]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m21:33:46.104962 [info ] [Thread-2  ]: 2 of 2 START sql view model public.users_model ................................. [RUN]
[0m21:33:46.106255 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.dbt_test.my_first_dbt_model)
[0m21:33:46.107481 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.dbt_test.users_model'
[0m21:33:46.108203 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:33:46.108785 [debug] [Thread-2  ]: Began compiling node model.dbt_test.users_model
[0m21:33:46.121333 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:33:46.125865 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_test.users_model"
[0m21:33:46.127988 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (compile): 21:33:46.109155 => 21:33:46.127216
[0m21:33:46.128927 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (compile): 21:33:46.121856 => 21:33:46.128519
[0m21:33:46.129824 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:33:46.130573 [debug] [Thread-2  ]: Began executing node model.dbt_test.users_model
[0m21:33:46.223304 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_test.users_model"
[0m21:33:46.228424 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:33:46.229519 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:33:46.230115 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:33:46.230602 [debug] [Thread-2  ]: On model.dbt_test.users_model: BEGIN
[0m21:33:46.231138 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:33:46.231792 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:33:46.232325 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:33:46.239383 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m21:33:46.240023 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:33:46.240677 [debug] [Thread-2  ]: On model.dbt_test.users_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users_model"} */

  create view "dbt_db"."public"."users_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select id, user_name from users
  );
[0m21:33:46.241272 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:33:46.241917 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:33:46.242562 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 9: select id, user_name from users
                                  ^

[0m21:33:46.243096 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:33:46.243681 [debug] [Thread-2  ]: On model.dbt_test.users_model: ROLLBACK
[0m21:33:46.244851 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (execute): 21:33:46.149802 => 21:33:46.244473
[0m21:33:46.245570 [debug] [Thread-2  ]: On model.dbt_test.users_model: Close
[0m21:33:46.249446 [debug] [Thread-2  ]: Database Error in model users_model (models/example/users_model.sql)
  relation "users" does not exist
  LINE 9: select id, user_name from users
                                    ^
  compiled Code at target/run/dbt_test/models/example/users_model.sql
[0m21:33:46.250271 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bc57aa-0411-4d73-8295-45913551c30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fcdb9370>]}
[0m21:33:46.251904 [error] [Thread-2  ]: 2 of 2 ERROR creating sql view model public.users_model ........................ [[31mERROR[0m in 0.14s]
[0m21:33:46.253221 [debug] [Thread-2  ]: Finished running node model.dbt_test.users_model
[0m21:33:46.288881 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m21:33:46.301913 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:33:46.302760 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:33:46.303964 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:33:46.309257 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:33:46.310324 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:33:46.352251 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:33:46.391796 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:33:46.392518 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:33:46.393083 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:33:46.394317 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:33:46.463186 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."my_first_dbt_model__dbt_backup"
[0m21:33:46.471009 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:33:46.471750 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m21:33:46.519502 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:33:46.522095 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (execute): 21:33:46.130995 => 21:33:46.521715
[0m21:33:46.522810 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: Close
[0m21:33:46.524081 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2bc57aa-0411-4d73-8295-45913551c30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fce2ce20>]}
[0m21:33:46.525132 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.42s]
[0m21:33:46.526202 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:33:46.528449 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:46.529090 [debug] [MainThread]: On master: BEGIN
[0m21:33:46.529691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:33:46.537412 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:33:46.538319 [debug] [MainThread]: On master: COMMIT
[0m21:33:46.539960 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:46.541146 [debug] [MainThread]: On master: COMMIT
[0m21:33:46.543282 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:33:46.544613 [debug] [MainThread]: On master: Close
[0m21:33:46.546351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:46.547271 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m21:33:46.547920 [debug] [MainThread]: Connection 'model.dbt_test.users_model' was properly closed.
[0m21:33:46.548584 [info ] [MainThread]: 
[0m21:33:46.549477 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m21:33:46.551047 [debug] [MainThread]: Command end result
[0m21:33:46.564551 [info ] [MainThread]: 
[0m21:33:46.565906 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:33:46.566774 [info ] [MainThread]: 
[0m21:33:46.568300 [error] [MainThread]:   Database Error in model users_model (models/example/users_model.sql)
  relation "users" does not exist
  LINE 9: select id, user_name from users
                                    ^
  compiled Code at target/run/dbt_test/models/example/users_model.sql
[0m21:33:46.569388 [info ] [MainThread]: 
[0m21:33:46.571337 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:33:46.574870 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4268632, "process_user_time": 3.555388, "process_kernel_time": 0.335632, "process_mem_max_rss": "108974080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:33:46.576272 [debug] [MainThread]: Command `dbt run` failed at 21:33:46.575887 after 1.43 seconds
[0m21:33:46.577254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fa729b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fc44fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6fcaa5bb0>]}
[0m21:33:46.578673 [debug] [MainThread]: Flushing usage events
[0m21:35:16.725088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d472ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d6c9baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d6cc56a0>]}


============================== 21:35:16.729648 | 91fc8ec4-34ef-4d66-9a16-94a8b867c2ca ==============================
[0m21:35:16.729648 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:35:16.730485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:35:17.022790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91fc8ec4-34ef-4d66-9a16-94a8b867c2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d6c6db50>]}
[0m21:35:17.138154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91fc8ec4-34ef-4d66-9a16-94a8b867c2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d6f3ed90>]}
[0m21:35:17.139183 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:35:17.163982 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:35:17.215811 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m21:35:17.216634 [debug] [MainThread]: Partial parsing: deleted file: dbt_test://models/example/my_first_dbt_model.sql
[0m21:35:17.237452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91fc8ec4-34ef-4d66-9a16-94a8b867c2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d71300d0>]}
[0m21:35:17.256941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91fc8ec4-34ef-4d66-9a16-94a8b867c2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d71fc970>]}
[0m21:35:17.257691 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:35:17.258314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91fc8ec4-34ef-4d66-9a16-94a8b867c2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d71fca60>]}
[0m21:35:17.260287 [info ] [MainThread]: 
[0m21:35:17.261427 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:35:17.263052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m21:35:17.279685 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m21:35:17.280471 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m21:35:17.281062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:17.325336 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:35:17.329143 [debug] [ThreadPool]: On list_dbt_db: Close
[0m21:35:17.331608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m21:35:17.344272 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:35:17.345110 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m21:35:17.345869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:17.353081 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:35:17.353785 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:35:17.354408 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:35:17.359661 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:35:17.361598 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m21:35:17.362339 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m21:35:17.369819 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:17.370515 [debug] [MainThread]: On master: BEGIN
[0m21:35:17.371049 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:17.377399 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:35:17.378096 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:17.378763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:35:17.389510 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:35:17.391195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91fc8ec4-34ef-4d66-9a16-94a8b867c2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d72ff760>]}
[0m21:35:17.391896 [debug] [MainThread]: On master: ROLLBACK
[0m21:35:17.392573 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:17.393102 [debug] [MainThread]: On master: BEGIN
[0m21:35:17.393907 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:35:17.394552 [debug] [MainThread]: On master: COMMIT
[0m21:35:17.395151 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:17.395723 [debug] [MainThread]: On master: COMMIT
[0m21:35:17.396458 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:35:17.397418 [debug] [MainThread]: On master: Close
[0m21:35:17.398618 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:35:17.399316 [info ] [MainThread]: 
[0m21:35:17.403023 [debug] [Thread-1  ]: Began running node model.dbt_test.users_model
[0m21:35:17.403894 [info ] [Thread-1  ]: 1 of 1 START sql view model public.users_model ................................. [RUN]
[0m21:35:17.405644 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.dbt_test.users_model)
[0m21:35:17.406436 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users_model
[0m21:35:17.416936 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users_model"
[0m21:35:17.418591 [debug] [Thread-1  ]: Timing info for model.dbt_test.users_model (compile): 21:35:17.406865 => 21:35:17.417814
[0m21:35:17.419806 [debug] [Thread-1  ]: Began executing node model.dbt_test.users_model
[0m21:35:17.476712 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users_model"
[0m21:35:17.477822 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:35:17.478389 [debug] [Thread-1  ]: On model.dbt_test.users_model: BEGIN
[0m21:35:17.478917 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:35:17.484964 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:35:17.485633 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:35:17.486210 [debug] [Thread-1  ]: On model.dbt_test.users_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users_model"} */

  create view "dbt_db"."public"."users_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select id, user_name from users
  );
[0m21:35:17.487274 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 9: select id, user_name from users
                                  ^

[0m21:35:17.487873 [debug] [Thread-1  ]: On model.dbt_test.users_model: ROLLBACK
[0m21:35:17.488834 [debug] [Thread-1  ]: Timing info for model.dbt_test.users_model (execute): 21:35:17.420870 => 21:35:17.488501
[0m21:35:17.489410 [debug] [Thread-1  ]: On model.dbt_test.users_model: Close
[0m21:35:17.492285 [debug] [Thread-1  ]: Database Error in model users_model (models/example/users_model.sql)
  relation "users" does not exist
  LINE 9: select id, user_name from users
                                    ^
  compiled Code at target/run/dbt_test/models/example/users_model.sql
[0m21:35:17.493020 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91fc8ec4-34ef-4d66-9a16-94a8b867c2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d7317dc0>]}
[0m21:35:17.493863 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.users_model ........................ [[31mERROR[0m in 0.09s]
[0m21:35:17.494832 [debug] [Thread-1  ]: Finished running node model.dbt_test.users_model
[0m21:35:17.497123 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:17.497642 [debug] [MainThread]: On master: BEGIN
[0m21:35:17.498165 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:35:17.504522 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:35:17.505150 [debug] [MainThread]: On master: COMMIT
[0m21:35:17.505663 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:17.506182 [debug] [MainThread]: On master: COMMIT
[0m21:35:17.506957 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:35:17.507735 [debug] [MainThread]: On master: Close
[0m21:35:17.508747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:17.509260 [debug] [MainThread]: Connection 'model.dbt_test.users_model' was properly closed.
[0m21:35:17.509845 [info ] [MainThread]: 
[0m21:35:17.510541 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m21:35:17.511880 [debug] [MainThread]: Command end result
[0m21:35:17.524729 [info ] [MainThread]: 
[0m21:35:17.525546 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:35:17.526155 [info ] [MainThread]: 
[0m21:35:17.526745 [error] [MainThread]:   Database Error in model users_model (models/example/users_model.sql)
  relation "users" does not exist
  LINE 9: select id, user_name from users
                                    ^
  compiled Code at target/run/dbt_test/models/example/users_model.sql
[0m21:35:17.527327 [info ] [MainThread]: 
[0m21:35:17.527949 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:35:17.530010 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8718681, "process_user_time": 3.092941, "process_kernel_time": 0.316199, "process_mem_max_rss": "104239104", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:35:17.531611 [debug] [MainThread]: Command `dbt run` failed at 21:35:17.531341 after 0.87 seconds
[0m21:35:17.532360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d472ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d6f7e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d704d610>]}
[0m21:35:17.533060 [debug] [MainThread]: Flushing usage events
[0m21:35:42.156589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb443e2f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44659c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4465c6220>]}


============================== 21:35:42.161799 | a2f7fc96-850d-4898-babd-281910365baf ==============================
[0m21:35:42.161799 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:35:42.162631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amal/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:35:42.445998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2f7fc96-850d-4898-babd-281910365baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb445089f40>]}
[0m21:35:42.559259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2f7fc96-850d-4898-babd-281910365baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44679fa30>]}
[0m21:35:42.560312 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:35:42.582920 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:35:42.630886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:35:42.631707 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/example/my_first_dbt_model.sql
[0m21:35:42.806048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2f7fc96-850d-4898-babd-281910365baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb446d170d0>]}
[0m21:35:42.824190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2f7fc96-850d-4898-babd-281910365baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb446a85cd0>]}
[0m21:35:42.824919 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:35:42.825651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2f7fc96-850d-4898-babd-281910365baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb446a85c40>]}
[0m21:35:42.827636 [info ] [MainThread]: 
[0m21:35:42.828763 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:35:42.830140 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m21:35:42.847177 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m21:35:42.847879 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m21:35:42.848449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:42.885830 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:35:42.888081 [debug] [ThreadPool]: On list_dbt_db: Close
[0m21:35:42.890401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m21:35:42.900596 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:35:42.901402 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m21:35:42.902037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:42.909509 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:35:42.910319 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:35:42.910961 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:35:42.916153 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:35:42.918110 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m21:35:42.918910 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m21:35:42.926474 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:42.927159 [debug] [MainThread]: On master: BEGIN
[0m21:35:42.927705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:42.933840 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:35:42.934507 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:42.935188 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:35:42.945960 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:35:42.947621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2f7fc96-850d-4898-babd-281910365baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb446ba4790>]}
[0m21:35:42.948313 [debug] [MainThread]: On master: ROLLBACK
[0m21:35:42.948989 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:42.949514 [debug] [MainThread]: On master: BEGIN
[0m21:35:42.950399 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:35:42.951575 [debug] [MainThread]: On master: COMMIT
[0m21:35:42.952179 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:42.952701 [debug] [MainThread]: On master: COMMIT
[0m21:35:42.953401 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:35:42.953961 [debug] [MainThread]: On master: Close
[0m21:35:42.954970 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:35:42.955544 [info ] [MainThread]: 
[0m21:35:42.959353 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m21:35:42.960061 [debug] [Thread-2  ]: Began running node model.dbt_test.users_model
[0m21:35:42.960912 [info ] [Thread-1  ]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m21:35:42.961871 [info ] [Thread-2  ]: 2 of 2 START sql view model public.users_model ................................. [RUN]
[0m21:35:42.962950 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.dbt_test.my_first_dbt_model)
[0m21:35:42.964109 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.dbt_test.users_model'
[0m21:35:42.964753 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:35:42.965352 [debug] [Thread-2  ]: Began compiling node model.dbt_test.users_model
[0m21:35:42.976646 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:35:42.979561 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_test.users_model"
[0m21:35:42.980943 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (compile): 21:35:42.965744 => 21:35:42.980520
[0m21:35:42.981793 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (compile): 21:35:42.977153 => 21:35:42.981446
[0m21:35:42.983454 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:35:42.984814 [debug] [Thread-2  ]: Began executing node model.dbt_test.users_model
[0m21:35:43.080611 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_test.users_model"
[0m21:35:43.086740 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:35:43.087990 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:35:43.088605 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:35:43.089106 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:35:43.089659 [debug] [Thread-2  ]: On model.dbt_test.users_model: BEGIN
[0m21:35:43.090197 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:35:43.090726 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:35:43.097963 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m21:35:43.098776 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:35:43.099434 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:35:43.100098 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:35:43.100685 [debug] [Thread-2  ]: On model.dbt_test.users_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users_model"} */

  create view "dbt_db"."public"."users_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select id, user_name from users
  );
[0m21:35:43.101274 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:35:43.102438 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 9: select id, user_name from users
                                  ^

[0m21:35:43.103028 [debug] [Thread-2  ]: On model.dbt_test.users_model: ROLLBACK
[0m21:35:43.104061 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (execute): 21:35:43.007926 => 21:35:43.103676
[0m21:35:43.104675 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m21:35:43.105259 [debug] [Thread-2  ]: On model.dbt_test.users_model: Close
[0m21:35:43.113232 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:35:43.114837 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:35:43.116899 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:35:43.121701 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:35:43.122324 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:35:43.123959 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:35:43.131451 [debug] [Thread-2  ]: Database Error in model users_model (models/example/users_model.sql)
  relation "users" does not exist
  LINE 9: select id, user_name from users
                                    ^
  compiled Code at target/run/dbt_test/models/example/users_model.sql
[0m21:35:43.137707 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2f7fc96-850d-4898-babd-281910365baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb446e57af0>]}
[0m21:35:43.153419 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:35:43.154384 [error] [Thread-2  ]: 2 of 2 ERROR creating sql view model public.users_model ........................ [[31mERROR[0m in 0.17s]
[0m21:35:43.155156 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:35:43.155956 [debug] [Thread-2  ]: Finished running node model.dbt_test.users_model
[0m21:35:43.156553 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:35:43.158376 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:35:43.169152 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."my_first_dbt_model__dbt_backup"
[0m21:35:43.178175 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:35:43.179203 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m21:35:43.182762 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:35:43.185692 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (execute): 21:35:42.985568 => 21:35:43.185355
[0m21:35:43.186373 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: Close
[0m21:35:43.187458 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2f7fc96-850d-4898-babd-281910365baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb446e209d0>]}
[0m21:35:43.188369 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m21:35:43.189300 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:35:43.191359 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:43.191953 [debug] [MainThread]: On master: BEGIN
[0m21:35:43.192675 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:35:43.200334 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:35:43.201028 [debug] [MainThread]: On master: COMMIT
[0m21:35:43.201594 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:43.202151 [debug] [MainThread]: On master: COMMIT
[0m21:35:43.202885 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:35:43.203509 [debug] [MainThread]: On master: Close
[0m21:35:43.204542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:43.205099 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m21:35:43.205649 [debug] [MainThread]: Connection 'model.dbt_test.users_model' was properly closed.
[0m21:35:43.206267 [info ] [MainThread]: 
[0m21:35:43.206899 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m21:35:43.208162 [debug] [MainThread]: Command end result
[0m21:35:43.223038 [info ] [MainThread]: 
[0m21:35:43.223863 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:35:43.224487 [info ] [MainThread]: 
[0m21:35:43.225121 [error] [MainThread]:   Database Error in model users_model (models/example/users_model.sql)
  relation "users" does not exist
  LINE 9: select id, user_name from users
                                    ^
  compiled Code at target/run/dbt_test/models/example/users_model.sql
[0m21:35:43.225756 [info ] [MainThread]: 
[0m21:35:43.226470 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:35:43.228929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1388829, "process_user_time": 3.368578, "process_kernel_time": 0.33104, "process_mem_max_rss": "108384256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:35:43.230687 [debug] [MainThread]: Command `dbt run` failed at 21:35:43.230203 after 1.14 seconds
[0m21:35:43.231893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb443e2f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4465a91c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4468570a0>]}
[0m21:35:43.233532 [debug] [MainThread]: Flushing usage events
[0m21:36:51.878293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5baf2a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bcc5dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bcc87d30>]}


============================== 21:36:51.882851 | a3419bf9-5932-4e74-b793-ada0228e6487 ==============================
[0m21:36:51.882851 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:36:51.883649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'profiles_dir': '/Users/amal/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:36:52.153537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3419bf9-5932-4e74-b793-ada0228e6487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bcc48e50>]}
[0m21:36:52.259017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3419bf9-5932-4e74-b793-ada0228e6487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bcdfe850>]}
[0m21:36:52.260027 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:36:52.282998 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:36:52.332001 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m21:36:52.332832 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/example/users/schema.yml
[0m21:36:52.333405 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/example/users/users_model.sql
[0m21:36:52.333940 [debug] [MainThread]: Partial parsing: deleted file: dbt_test://models/example/users_model.sql
[0m21:36:52.600552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3419bf9-5932-4e74-b793-ada0228e6487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bd4bd0d0>]}
[0m21:36:52.618049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3419bf9-5932-4e74-b793-ada0228e6487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bd285e20>]}
[0m21:36:52.618742 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:36:52.619432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3419bf9-5932-4e74-b793-ada0228e6487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bd285d60>]}
[0m21:36:52.621574 [info ] [MainThread]: 
[0m21:36:52.622725 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:36:52.624098 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m21:36:52.639661 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m21:36:52.640327 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m21:36:52.640849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:52.677082 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:36:52.679290 [debug] [ThreadPool]: On list_dbt_db: Close
[0m21:36:52.681601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m21:36:52.690968 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:36:52.691662 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m21:36:52.692212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:52.698349 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:36:52.698996 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:36:52.699562 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:36:52.703776 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:36:52.705579 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m21:36:52.706289 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m21:36:52.712658 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:52.713261 [debug] [MainThread]: On master: BEGIN
[0m21:36:52.713768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:36:52.719488 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:36:52.720128 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:52.720756 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:36:52.729559 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:36:52.731107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3419bf9-5932-4e74-b793-ada0228e6487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bd5d1880>]}
[0m21:36:52.731783 [debug] [MainThread]: On master: ROLLBACK
[0m21:36:52.732426 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:52.732935 [debug] [MainThread]: On master: BEGIN
[0m21:36:52.733646 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:36:52.734229 [debug] [MainThread]: On master: COMMIT
[0m21:36:52.734747 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:52.735247 [debug] [MainThread]: On master: COMMIT
[0m21:36:52.735874 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:36:52.736394 [debug] [MainThread]: On master: Close
[0m21:36:52.737368 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:36:52.737948 [info ] [MainThread]: 
[0m21:36:52.741526 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m21:36:52.742185 [debug] [Thread-2  ]: Began running node model.dbt_test.users_model
[0m21:36:52.742951 [info ] [Thread-1  ]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m21:36:52.743948 [info ] [Thread-2  ]: 2 of 2 START sql view model public.users_model ................................. [RUN]
[0m21:36:52.745381 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.dbt_test.my_first_dbt_model)
[0m21:36:52.746622 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.dbt_test.users_model'
[0m21:36:52.747321 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:36:52.747893 [debug] [Thread-2  ]: Began compiling node model.dbt_test.users_model
[0m21:36:52.759600 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:36:52.763038 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_test.users_model"
[0m21:36:52.764499 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (compile): 21:36:52.748280 => 21:36:52.764032
[0m21:36:52.765334 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:36:52.776783 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (compile): 21:36:52.760283 => 21:36:52.776249
[0m21:36:52.801163 [debug] [Thread-2  ]: Began executing node model.dbt_test.users_model
[0m21:36:52.835136 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:36:52.852316 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_test.users_model"
[0m21:36:52.853490 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:36:52.854102 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:36:52.854636 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:36:52.855530 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:36:52.856380 [debug] [Thread-2  ]: On model.dbt_test.users_model: BEGIN
[0m21:36:52.857279 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:36:52.862944 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:36:52.863639 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:36:52.864580 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:36:52.865257 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m21:36:52.865913 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:36:52.866476 [debug] [Thread-2  ]: On model.dbt_test.users_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users_model"} */

  create view "dbt_db"."public"."users_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select id, user_name from users
  );
[0m21:36:52.867188 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m21:36:52.867892 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 9: select id, user_name from users
                                  ^

[0m21:36:52.875877 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:36:52.876566 [debug] [Thread-2  ]: On model.dbt_test.users_model: ROLLBACK
[0m21:36:52.877181 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:36:52.878232 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (execute): 21:36:52.826725 => 21:36:52.877874
[0m21:36:52.878798 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:36:52.879316 [debug] [Thread-2  ]: On model.dbt_test.users_model: Close
[0m21:36:52.883517 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:36:52.885163 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:36:52.886621 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:36:52.911914 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:36:52.913010 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:36:52.913742 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:36:52.914989 [debug] [Thread-2  ]: Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 9: select id, user_name from users
                                    ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:36:52.915580 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:36:52.916171 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3419bf9-5932-4e74-b793-ada0228e6487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bd5d28e0>]}
[0m21:36:52.924581 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."my_first_dbt_model__dbt_backup"
[0m21:36:52.925525 [error] [Thread-2  ]: 2 of 2 ERROR creating sql view model public.users_model ........................ [[31mERROR[0m in 0.17s]
[0m21:36:52.932810 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:36:52.934342 [debug] [Thread-2  ]: Finished running node model.dbt_test.users_model
[0m21:36:52.935104 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m21:36:52.938310 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:36:52.940900 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (execute): 21:36:52.765846 => 21:36:52.940502
[0m21:36:52.941859 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: Close
[0m21:36:52.944494 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3419bf9-5932-4e74-b793-ada0228e6487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bd5381c0>]}
[0m21:36:52.946938 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m21:36:52.949469 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:36:52.953547 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:52.954833 [debug] [MainThread]: On master: BEGIN
[0m21:36:52.955631 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:36:52.970964 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:36:52.972849 [debug] [MainThread]: On master: COMMIT
[0m21:36:52.974494 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:52.975877 [debug] [MainThread]: On master: COMMIT
[0m21:36:52.977521 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:36:52.979088 [debug] [MainThread]: On master: Close
[0m21:36:52.981717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:52.983658 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m21:36:52.985125 [debug] [MainThread]: Connection 'model.dbt_test.users_model' was properly closed.
[0m21:36:52.986615 [info ] [MainThread]: 
[0m21:36:52.989024 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m21:36:52.991830 [debug] [MainThread]: Command end result
[0m21:36:53.086130 [info ] [MainThread]: 
[0m21:36:53.086975 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:36:53.087643 [info ] [MainThread]: 
[0m21:36:53.088494 [error] [MainThread]:   Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 9: select id, user_name from users
                                    ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:36:53.089193 [info ] [MainThread]: 
[0m21:36:53.089898 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:36:53.092103 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2775662, "process_user_time": 3.358831, "process_kernel_time": 0.306282, "process_mem_max_rss": "109158400", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:36:53.093741 [debug] [MainThread]: Command `dbt run` failed at 21:36:53.093181 after 1.28 seconds
[0m21:36:53.095007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5baf2a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bc39bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bd5284c0>]}
[0m21:36:53.096539 [debug] [MainThread]: Flushing usage events
[0m21:38:07.193185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68676a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68945eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc689487a00>]}


============================== 21:38:07.197693 | 8cfc3930-d886-4044-9c8a-d9d20a7cc385 ==============================
[0m21:38:07.197693 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:38:07.198681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:38:07.473694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cfc3930-d886-4044-9c8a-d9d20a7cc385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6895fdf10>]}
[0m21:38:07.582171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cfc3930-d886-4044-9c8a-d9d20a7cc385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc689430fa0>]}
[0m21:38:07.583360 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:38:07.605836 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:38:07.652364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:38:07.653492 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/example/users/users_model.sql
[0m21:38:07.822915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cfc3930-d886-4044-9c8a-d9d20a7cc385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc689ab80d0>]}
[0m21:38:07.841132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cfc3930-d886-4044-9c8a-d9d20a7cc385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6898bdbe0>]}
[0m21:38:07.842154 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:38:07.843113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cfc3930-d886-4044-9c8a-d9d20a7cc385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6896fd1f0>]}
[0m21:38:07.845115 [info ] [MainThread]: 
[0m21:38:07.846298 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:38:07.847726 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m21:38:07.864472 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m21:38:07.865190 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m21:38:07.865747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:07.905047 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:38:07.907453 [debug] [ThreadPool]: On list_dbt_db: Close
[0m21:38:07.909919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m21:38:07.918885 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:38:07.919681 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m21:38:07.920285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:38:07.926429 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:38:07.927057 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:38:07.927625 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:38:07.931699 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:38:07.933371 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m21:38:07.934040 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m21:38:07.940573 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:07.941193 [debug] [MainThread]: On master: BEGIN
[0m21:38:07.941694 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:38:07.947368 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:38:07.948000 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:07.948680 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:38:07.957840 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:38:07.959440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cfc3930-d886-4044-9c8a-d9d20a7cc385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6898bda60>]}
[0m21:38:07.960106 [debug] [MainThread]: On master: ROLLBACK
[0m21:38:07.960742 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:07.961247 [debug] [MainThread]: On master: BEGIN
[0m21:38:07.961927 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:38:07.962437 [debug] [MainThread]: On master: COMMIT
[0m21:38:07.962938 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:07.963423 [debug] [MainThread]: On master: COMMIT
[0m21:38:07.964080 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:38:07.964610 [debug] [MainThread]: On master: Close
[0m21:38:07.965611 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:38:07.966264 [info ] [MainThread]: 
[0m21:38:07.969778 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m21:38:07.970472 [debug] [Thread-2  ]: Began running node model.dbt_test.users_model
[0m21:38:07.971160 [info ] [Thread-1  ]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m21:38:07.972151 [info ] [Thread-2  ]: 2 of 2 START sql table model public.users_model ................................ [RUN]
[0m21:38:07.973392 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.dbt_test.my_first_dbt_model)
[0m21:38:07.974604 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.dbt_test.users_model'
[0m21:38:07.975313 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:38:07.975939 [debug] [Thread-2  ]: Began compiling node model.dbt_test.users_model
[0m21:38:07.988358 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:38:07.992435 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_test.users_model"
[0m21:38:07.994095 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (compile): 21:38:07.976333 => 21:38:07.993664
[0m21:38:07.994860 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (compile): 21:38:07.988871 => 21:38:07.994491
[0m21:38:07.995733 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:38:07.996749 [debug] [Thread-2  ]: Began executing node model.dbt_test.users_model
[0m21:38:08.088850 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_test.users_model"
[0m21:38:08.091933 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:38:08.092985 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:38:08.093582 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:38:08.094076 [debug] [Thread-2  ]: On model.dbt_test.users_model: BEGIN
[0m21:38:08.094625 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:38:08.095160 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:38:08.095695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:38:08.103178 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m21:38:08.103912 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:38:08.104485 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:38:08.105117 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:38:08.105765 [debug] [Thread-2  ]: On model.dbt_test.users_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users_model"} */

  
    

  create  table "dbt_db"."public"."users_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select id, user_name from users
  );
  
[0m21:38:08.106354 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:38:08.107503 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 14: select id, user_name from users
                                   ^

[0m21:38:08.108093 [debug] [Thread-2  ]: On model.dbt_test.users_model: ROLLBACK
[0m21:38:08.109111 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (execute): 21:38:08.022042 => 21:38:08.108741
[0m21:38:08.109694 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m21:38:08.110282 [debug] [Thread-2  ]: On model.dbt_test.users_model: Close
[0m21:38:08.118360 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:38:08.119935 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:38:08.121112 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:38:08.125540 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:38:08.126140 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:38:08.127323 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:38:08.154090 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:38:08.154977 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:38:08.155579 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:38:08.156982 [debug] [Thread-2  ]: Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 14: select id, user_name from users
                                     ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:38:08.157698 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:38:08.158434 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cfc3930-d886-4044-9c8a-d9d20a7cc385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc689be3b80>]}
[0m21:38:08.167368 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."my_first_dbt_model__dbt_backup"
[0m21:38:08.169056 [error] [Thread-2  ]: 2 of 2 ERROR creating sql table model public.users_model ....................... [[31mERROR[0m in 0.18s]
[0m21:38:08.175763 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:38:08.177025 [debug] [Thread-2  ]: Finished running node model.dbt_test.users_model
[0m21:38:08.177906 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m21:38:08.181372 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:38:08.185167 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (execute): 21:38:07.997573 => 21:38:08.184751
[0m21:38:08.186026 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: Close
[0m21:38:08.187617 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cfc3930-d886-4044-9c8a-d9d20a7cc385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc689baec10>]}
[0m21:38:08.189110 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.21s]
[0m21:38:08.190599 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:38:08.193085 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:08.193877 [debug] [MainThread]: On master: BEGIN
[0m21:38:08.194475 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:38:08.203179 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:38:08.204050 [debug] [MainThread]: On master: COMMIT
[0m21:38:08.204700 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:08.205281 [debug] [MainThread]: On master: COMMIT
[0m21:38:08.206076 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:38:08.206708 [debug] [MainThread]: On master: Close
[0m21:38:08.207865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:38:08.208431 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m21:38:08.208988 [debug] [MainThread]: Connection 'model.dbt_test.users_model' was properly closed.
[0m21:38:08.209603 [info ] [MainThread]: 
[0m21:38:08.210255 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m21:38:08.211583 [debug] [MainThread]: Command end result
[0m21:38:08.228642 [info ] [MainThread]: 
[0m21:38:08.229451 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:38:08.230072 [info ] [MainThread]: 
[0m21:38:08.230691 [error] [MainThread]:   Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 14: select id, user_name from users
                                     ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:38:08.231331 [info ] [MainThread]: 
[0m21:38:08.231984 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:38:08.234232 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1077583, "process_user_time": 3.347815, "process_kernel_time": 0.317648, "process_mem_max_rss": "108609536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:38:08.236219 [debug] [MainThread]: Command `dbt run` failed at 21:38:08.235868 after 1.11 seconds
[0m21:38:08.237149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68676a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc68962ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6896b03d0>]}
[0m21:38:08.238068 [debug] [MainThread]: Flushing usage events
[0m21:43:18.632315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f772b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f9c9b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f9cc6220>]}


============================== 21:43:18.637059 | eb27471e-e9eb-49b6-923d-752f511e3b94 ==============================
[0m21:43:18.637059 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:43:18.637900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'version_check': 'True', 'profiles_dir': '/Users/amal/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:43:18.948349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb27471e-e9eb-49b6-923d-752f511e3b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f8889f40>]}
[0m21:43:19.058653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb27471e-e9eb-49b6-923d-752f511e3b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f9fdda30>]}
[0m21:43:19.060030 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:43:19.082029 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:43:19.136713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:43:19.137604 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/example/users/schema.yml
[0m21:43:19.203576 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/users/schema.yml'
[0m21:43:19.342093 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_test.unique_my_second_dbt_model_id.57a0f8c493' (models/example/users/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m21:43:19.343057 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_test.not_null_my_second_dbt_model_id.151b76d778' (models/example/users/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m21:43:19.364392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb27471e-e9eb-49b6-923d-752f511e3b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8fa48de80>]}
[0m21:43:19.386099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb27471e-e9eb-49b6-923d-752f511e3b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8fa23bc70>]}
[0m21:43:19.387168 [info ] [MainThread]: Found 2 models, 2 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:43:19.387937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb27471e-e9eb-49b6-923d-752f511e3b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8fa0f1340>]}
[0m21:43:19.391319 [info ] [MainThread]: 
[0m21:43:19.392793 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:43:19.394611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m21:43:19.413947 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m21:43:19.414733 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m21:43:19.415346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:19.455190 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:43:19.457960 [debug] [ThreadPool]: On list_dbt_db: Close
[0m21:43:19.460771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m21:43:19.470324 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:43:19.471026 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m21:43:19.471580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:19.478126 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:43:19.478793 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:43:19.479390 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:43:19.483859 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:43:19.485650 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m21:43:19.486350 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m21:43:19.492881 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:19.493528 [debug] [MainThread]: On master: BEGIN
[0m21:43:19.494040 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:43:19.499722 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:43:19.500340 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:19.500987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:43:19.510092 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:43:19.511692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb27471e-e9eb-49b6-923d-752f511e3b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8fa23b0a0>]}
[0m21:43:19.512374 [debug] [MainThread]: On master: ROLLBACK
[0m21:43:19.513032 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:19.513546 [debug] [MainThread]: On master: BEGIN
[0m21:43:19.514303 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:43:19.514846 [debug] [MainThread]: On master: COMMIT
[0m21:43:19.515363 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:19.515865 [debug] [MainThread]: On master: COMMIT
[0m21:43:19.516477 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:43:19.517010 [debug] [MainThread]: On master: Close
[0m21:43:19.517987 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:43:19.518553 [info ] [MainThread]: 
[0m21:43:19.522807 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m21:43:19.523487 [debug] [Thread-2  ]: Began running node model.dbt_test.users_model
[0m21:43:19.524482 [info ] [Thread-1  ]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m21:43:19.525460 [info ] [Thread-2  ]: 2 of 2 START sql table model public.users_model ................................ [RUN]
[0m21:43:19.526567 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.dbt_test.my_first_dbt_model)
[0m21:43:19.527700 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.dbt_test.users_model'
[0m21:43:19.528324 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:43:19.528904 [debug] [Thread-2  ]: Began compiling node model.dbt_test.users_model
[0m21:43:19.540554 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:43:19.545337 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_test.users_model"
[0m21:43:19.546701 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (compile): 21:43:19.529289 => 21:43:19.546304
[0m21:43:19.547460 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (compile): 21:43:19.541291 => 21:43:19.547109
[0m21:43:19.548029 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:43:19.548663 [debug] [Thread-2  ]: Began executing node model.dbt_test.users_model
[0m21:43:19.628144 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_test.users_model"
[0m21:43:19.622931 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:43:19.629706 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:43:19.630285 [debug] [Thread-2  ]: On model.dbt_test.users_model: BEGIN
[0m21:43:19.630856 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:43:19.631874 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:43:19.632907 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:43:19.633829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:43:19.639440 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m21:43:19.640281 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:43:19.640946 [debug] [Thread-2  ]: On model.dbt_test.users_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users_model"} */

  
    

  create  table "dbt_db"."public"."users_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select id, user_name from users
  );
  
[0m21:43:19.642012 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:43:19.642583 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:43:19.643199 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 14: select id, user_name from users
                                   ^

[0m21:43:19.643756 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:43:19.644343 [debug] [Thread-2  ]: On model.dbt_test.users_model: ROLLBACK
[0m21:43:19.645376 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (execute): 21:43:19.573708 => 21:43:19.645058
[0m21:43:19.645948 [debug] [Thread-2  ]: On model.dbt_test.users_model: Close
[0m21:43:19.647459 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m21:43:19.656991 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:43:19.658243 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:43:19.659312 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:19.663661 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:43:19.664522 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:43:19.665979 [debug] [Thread-2  ]: Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 14: select id, user_name from users
                                     ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:43:19.666569 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:43:19.667198 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb27471e-e9eb-49b6-923d-752f511e3b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8fa55c850>]}
[0m21:43:19.693831 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:43:19.694774 [error] [Thread-2  ]: 2 of 2 ERROR creating sql table model public.users_model ....................... [[31mERROR[0m in 0.14s]
[0m21:43:19.695671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:43:19.696494 [debug] [Thread-2  ]: Finished running node model.dbt_test.users_model
[0m21:43:19.697051 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:43:19.698647 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:43:19.709599 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."my_first_dbt_model__dbt_backup"
[0m21:43:19.716848 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:43:19.717612 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m21:43:19.720562 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:43:19.722923 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (execute): 21:43:19.549100 => 21:43:19.722581
[0m21:43:19.723570 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: Close
[0m21:43:19.724862 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb27471e-e9eb-49b6-923d-752f511e3b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8fa5379a0>]}
[0m21:43:19.726087 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m21:43:19.727409 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:43:19.729917 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:19.730642 [debug] [MainThread]: On master: BEGIN
[0m21:43:19.731321 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:43:19.740429 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:43:19.741259 [debug] [MainThread]: On master: COMMIT
[0m21:43:19.742502 [debug] [MainThread]: Using postgres connection "master"
[0m21:43:19.743541 [debug] [MainThread]: On master: COMMIT
[0m21:43:19.744458 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:43:19.745564 [debug] [MainThread]: On master: Close
[0m21:43:19.746989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:43:19.748003 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m21:43:19.748788 [debug] [MainThread]: Connection 'model.dbt_test.users_model' was properly closed.
[0m21:43:19.749741 [info ] [MainThread]: 
[0m21:43:19.751077 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m21:43:19.752826 [debug] [MainThread]: Command end result
[0m21:43:19.768809 [info ] [MainThread]: 
[0m21:43:19.769735 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:43:19.770541 [info ] [MainThread]: 
[0m21:43:19.771259 [error] [MainThread]:   Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 14: select id, user_name from users
                                     ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:43:19.771934 [info ] [MainThread]: 
[0m21:43:19.772822 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:43:19.778401 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2134279, "process_user_time": 3.507667, "process_kernel_time": 0.426547, "process_mem_max_rss": "108355584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:43:19.781455 [debug] [MainThread]: Command `dbt run` failed at 21:43:19.780852 after 1.22 seconds
[0m21:43:19.783546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f772b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8fa537400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8fa5e99a0>]}
[0m21:43:19.785135 [debug] [MainThread]: Flushing usage events
[0m21:44:23.052356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f925d62ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f925f56e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f925f5c5760>]}


============================== 21:44:23.057433 | 3c62da67-2b24-4267-8eb7-e271fd6f5754 ==============================
[0m21:44:23.057433 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:44:23.058433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:44:23.059407 [info ] [MainThread]: dbt version: 1.7.11
[0m21:44:23.060066 [info ] [MainThread]: python version: 3.9.13
[0m21:44:23.060651 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m21:44:23.061268 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m21:44:23.195119 [info ] [MainThread]: Using profiles dir at /Users/amal/.dbt
[0m21:44:23.195881 [info ] [MainThread]: Using profiles.yml file at /Users/amal/.dbt/profiles.yml
[0m21:44:23.196485 [info ] [MainThread]: Using dbt_project.yml file at /Users/amal/Desktop/dbt/data_engineering/dbt_test/dbt_project.yml
[0m21:44:23.197322 [info ] [MainThread]: adapter type: postgres
[0m21:44:23.197969 [info ] [MainThread]: adapter version: 1.7.11
[0m21:44:23.376872 [info ] [MainThread]: Configuration:
[0m21:44:23.377769 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:44:23.378432 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:44:23.379082 [info ] [MainThread]: Required dependencies:
[0m21:44:23.379816 [debug] [MainThread]: Executing "git --help"
[0m21:44:23.390370 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:44:23.391917 [debug] [MainThread]: STDERR: "b''"
[0m21:44:23.392859 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:44:23.393857 [info ] [MainThread]: Connection:
[0m21:44:23.394992 [info ] [MainThread]:   host: localhost
[0m21:44:23.395639 [info ] [MainThread]:   port: 5432
[0m21:44:23.396180 [info ] [MainThread]:   user: amal
[0m21:44:23.396712 [info ] [MainThread]:   database: dbt_db
[0m21:44:23.397246 [info ] [MainThread]:   schema: public
[0m21:44:23.397775 [info ] [MainThread]:   connect_timeout: 10
[0m21:44:23.398324 [info ] [MainThread]:   role: None
[0m21:44:23.399015 [info ] [MainThread]:   search_path: None
[0m21:44:23.399583 [info ] [MainThread]:   keepalives_idle: 0
[0m21:44:23.400235 [info ] [MainThread]:   sslmode: None
[0m21:44:23.400832 [info ] [MainThread]:   sslcert: None
[0m21:44:23.401371 [info ] [MainThread]:   sslkey: None
[0m21:44:23.401909 [info ] [MainThread]:   sslrootcert: None
[0m21:44:23.402451 [info ] [MainThread]:   application_name: dbt
[0m21:44:23.403044 [info ] [MainThread]:   retries: 1
[0m21:44:23.404005 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:44:23.412206 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:44:23.413766 [debug] [MainThread]: Using postgres connection "debug"
[0m21:44:23.414677 [debug] [MainThread]: On debug: select 1 as id
[0m21:44:23.415393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:44:23.460128 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:44:23.462375 [debug] [MainThread]: On debug: Close
[0m21:44:23.463259 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:44:23.464145 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:44:23.467538 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.48932666, "process_user_time": 2.763626, "process_kernel_time": 0.391505, "process_mem_max_rss": "94875648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:44:23.469002 [debug] [MainThread]: Command `dbt debug` succeeded at 21:44:23.468666 after 0.49 seconds
[0m21:44:23.469876 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:44:23.471262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f925d62ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f925f5ab6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f925f768b50>]}
[0m21:44:23.472347 [debug] [MainThread]: Flushing usage events
[0m21:44:31.321441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb13f2abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1645ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb16487760>]}


============================== 21:44:31.326427 | 3b22f3a8-dd1a-4c77-9b5d-ca94511787b0 ==============================
[0m21:44:31.326427 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:44:31.327680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:44:31.634059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b22f3a8-dd1a-4c77-9b5d-ca94511787b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1642fb50>]}
[0m21:44:31.739744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b22f3a8-dd1a-4c77-9b5d-ca94511787b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb16773e50>]}
[0m21:44:31.740754 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:44:31.763680 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:44:31.812903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:44:31.813895 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/example/users/schema.yml
[0m21:44:31.997897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b22f3a8-dd1a-4c77-9b5d-ca94511787b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb16aafd60>]}
[0m21:44:32.015105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b22f3a8-dd1a-4c77-9b5d-ca94511787b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb168229d0>]}
[0m21:44:32.015800 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:44:32.016650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b22f3a8-dd1a-4c77-9b5d-ca94511787b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb168220d0>]}
[0m21:44:32.018494 [info ] [MainThread]: 
[0m21:44:32.019636 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:44:32.021421 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m21:44:32.038318 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m21:44:32.038997 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m21:44:32.039531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:32.060756 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:44:32.062858 [debug] [ThreadPool]: On list_dbt_db: Close
[0m21:44:32.064926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m21:44:32.075038 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:44:32.075742 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m21:44:32.076285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:32.082187 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:44:32.082828 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:44:32.083393 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:44:32.087697 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:44:32.089518 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m21:44:32.090243 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m21:44:32.096567 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:32.097165 [debug] [MainThread]: On master: BEGIN
[0m21:44:32.097653 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:44:32.103160 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:44:32.103767 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:32.104367 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:44:32.113314 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:44:32.114906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b22f3a8-dd1a-4c77-9b5d-ca94511787b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb16d08c10>]}
[0m21:44:32.115577 [debug] [MainThread]: On master: ROLLBACK
[0m21:44:32.116222 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:32.116732 [debug] [MainThread]: On master: BEGIN
[0m21:44:32.117466 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:44:32.118006 [debug] [MainThread]: On master: COMMIT
[0m21:44:32.118512 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:32.119005 [debug] [MainThread]: On master: COMMIT
[0m21:44:32.119598 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:44:32.120113 [debug] [MainThread]: On master: Close
[0m21:44:32.121099 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:44:32.121753 [info ] [MainThread]: 
[0m21:44:32.125185 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m21:44:32.125820 [debug] [Thread-2  ]: Began running node model.dbt_test.users_model
[0m21:44:32.126663 [info ] [Thread-1  ]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m21:44:32.127638 [info ] [Thread-2  ]: 2 of 2 START sql table model public.users_model ................................ [RUN]
[0m21:44:32.128751 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.dbt_test.my_first_dbt_model)
[0m21:44:32.129881 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.dbt_test.users_model'
[0m21:44:32.130582 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:44:32.131168 [debug] [Thread-2  ]: Began compiling node model.dbt_test.users_model
[0m21:44:32.146380 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:44:32.150589 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_test.users_model"
[0m21:44:32.151949 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (compile): 21:44:32.131562 => 21:44:32.151498
[0m21:44:32.153151 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (compile): 21:44:32.146936 => 21:44:32.152535
[0m21:44:32.153914 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:44:32.154708 [debug] [Thread-2  ]: Began executing node model.dbt_test.users_model
[0m21:44:32.252809 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:44:32.256214 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_test.users_model"
[0m21:44:32.257423 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:44:32.258028 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:44:32.258549 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:44:32.259105 [debug] [Thread-2  ]: On model.dbt_test.users_model: BEGIN
[0m21:44:32.259642 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:44:32.260169 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:44:32.267411 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:44:32.268062 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:44:32.268653 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m21:44:32.269235 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:44:32.269823 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:44:32.270511 [debug] [Thread-2  ]: On model.dbt_test.users_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users_model"} */

  
    

  create  table "dbt_db"."public"."users_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select id, user_name from users
  );
  
[0m21:44:32.271550 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 14: select id, user_name from users
                                   ^

[0m21:44:32.272118 [debug] [Thread-2  ]: On model.dbt_test.users_model: ROLLBACK
[0m21:44:32.272705 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m21:44:32.280033 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (execute): 21:44:32.173943 => 21:44:32.279680
[0m21:44:32.281894 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:44:32.282514 [debug] [Thread-2  ]: On model.dbt_test.users_model: Close
[0m21:44:32.283119 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:44:32.285483 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:32.290213 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:44:32.291011 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:44:32.292757 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:44:32.300047 [debug] [Thread-2  ]: Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 14: select id, user_name from users
                                     ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:44:32.319432 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:44:32.320249 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b22f3a8-dd1a-4c77-9b5d-ca94511787b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb16d72310>]}
[0m21:44:32.320862 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:44:32.321695 [error] [Thread-2  ]: 2 of 2 ERROR creating sql table model public.users_model ....................... [[31mERROR[0m in 0.19s]
[0m21:44:32.322417 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:44:32.323208 [debug] [Thread-2  ]: Finished running node model.dbt_test.users_model
[0m21:44:32.324738 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:44:32.336043 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."my_first_dbt_model__dbt_backup"
[0m21:44:32.345654 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:44:32.346804 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m21:44:32.350053 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:44:32.353324 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (execute): 21:44:32.155185 => 21:44:32.352972
[0m21:44:32.354041 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: Close
[0m21:44:32.355310 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b22f3a8-dd1a-4c77-9b5d-ca94511787b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb16cbd940>]}
[0m21:44:32.356412 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.23s]
[0m21:44:32.357594 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:44:32.359867 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:32.360786 [debug] [MainThread]: On master: BEGIN
[0m21:44:32.361761 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:44:32.370217 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:44:32.371044 [debug] [MainThread]: On master: COMMIT
[0m21:44:32.371700 [debug] [MainThread]: Using postgres connection "master"
[0m21:44:32.372295 [debug] [MainThread]: On master: COMMIT
[0m21:44:32.373086 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:44:32.374092 [debug] [MainThread]: On master: Close
[0m21:44:32.375635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:44:32.376323 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m21:44:32.376967 [debug] [MainThread]: Connection 'model.dbt_test.users_model' was properly closed.
[0m21:44:32.377631 [info ] [MainThread]: 
[0m21:44:32.378330 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m21:44:32.379712 [debug] [MainThread]: Command end result
[0m21:44:32.396727 [info ] [MainThread]: 
[0m21:44:32.397673 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:44:32.398534 [info ] [MainThread]: 
[0m21:44:32.399709 [error] [MainThread]:   Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 14: select id, user_name from users
                                     ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:44:32.400601 [info ] [MainThread]: 
[0m21:44:32.402087 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:44:32.405052 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1555336, "process_user_time": 3.268907, "process_kernel_time": 0.307679, "process_mem_max_rss": "108015616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:44:32.406903 [debug] [MainThread]: Command `dbt run` failed at 21:44:32.406293 after 1.16 seconds
[0m21:44:32.408167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb13f2abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb16723f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb16773e50>]}
[0m21:44:32.409006 [debug] [MainThread]: Flushing usage events
[0m21:44:54.794979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866872abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866a366b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866a3a6a30>]}


============================== 21:44:54.799612 | 20949a82-95fc-46c1-94c4-3d1832fbf4b1 ==============================
[0m21:44:54.799612 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:44:54.800516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:44:54.801333 [info ] [MainThread]: dbt version: 1.7.11
[0m21:44:54.801959 [info ] [MainThread]: python version: 3.9.13
[0m21:44:54.802554 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m21:44:54.803074 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m21:44:54.922819 [info ] [MainThread]: Using profiles dir at /Users/amal/.dbt
[0m21:44:54.923612 [info ] [MainThread]: Using profiles.yml file at /Users/amal/.dbt/profiles.yml
[0m21:44:54.924357 [info ] [MainThread]: Using dbt_project.yml file at /Users/amal/Desktop/dbt/data_engineering/dbt_test/dbt_project.yml
[0m21:44:54.925439 [info ] [MainThread]: adapter type: postgres
[0m21:44:54.926107 [info ] [MainThread]: adapter version: 1.7.11
[0m21:44:55.031308 [info ] [MainThread]: Configuration:
[0m21:44:55.032110 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:44:55.032724 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:44:55.033387 [info ] [MainThread]: Required dependencies:
[0m21:44:55.034070 [debug] [MainThread]: Executing "git --help"
[0m21:44:55.045021 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:44:55.047053 [debug] [MainThread]: STDERR: "b''"
[0m21:44:55.048218 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:44:55.049281 [info ] [MainThread]: Connection:
[0m21:44:55.049991 [info ] [MainThread]:   host: localhost
[0m21:44:55.050650 [info ] [MainThread]:   port: 5432
[0m21:44:55.051197 [info ] [MainThread]:   user: amal
[0m21:44:55.051764 [info ] [MainThread]:   database: dbt_db
[0m21:44:55.052434 [info ] [MainThread]:   schema: public
[0m21:44:55.053209 [info ] [MainThread]:   connect_timeout: 10
[0m21:44:55.053976 [info ] [MainThread]:   role: None
[0m21:44:55.054677 [info ] [MainThread]:   search_path: None
[0m21:44:55.055267 [info ] [MainThread]:   keepalives_idle: 0
[0m21:44:55.055853 [info ] [MainThread]:   sslmode: None
[0m21:44:55.056402 [info ] [MainThread]:   sslcert: None
[0m21:44:55.056929 [info ] [MainThread]:   sslkey: None
[0m21:44:55.057445 [info ] [MainThread]:   sslrootcert: None
[0m21:44:55.057960 [info ] [MainThread]:   application_name: dbt
[0m21:44:55.058485 [info ] [MainThread]:   retries: 1
[0m21:44:55.059299 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:44:55.065988 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:44:55.067456 [debug] [MainThread]: Using postgres connection "debug"
[0m21:44:55.068176 [debug] [MainThread]: On debug: select 1 as id
[0m21:44:55.068858 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:44:55.108907 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:44:55.111032 [debug] [MainThread]: On debug: Close
[0m21:44:55.111835 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:44:55.112549 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:44:55.115037 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.38429594, "process_user_time": 2.605889, "process_kernel_time": 0.231355, "process_mem_max_rss": "94920704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:44:55.116529 [debug] [MainThread]: Command `dbt debug` succeeded at 21:44:55.116152 after 0.39 seconds
[0m21:44:55.117338 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:44:55.118299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866872abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866a5f9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866a7a38e0>]}
[0m21:44:55.119596 [debug] [MainThread]: Flushing usage events
[0m21:45:00.837575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05af2d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05d59c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05d5c6220>]}


============================== 21:45:00.842205 | cb9805b8-c9b9-4395-8b85-561fb68b8441 ==============================
[0m21:45:00.842205 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:45:00.843167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:45:01.114766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb9805b8-c9b9-4395-8b85-561fb68b8441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05c089f40>]}
[0m21:45:01.221492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb9805b8-c9b9-4395-8b85-561fb68b8441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05d79ea30>]}
[0m21:45:01.222463 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:45:01.245822 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:45:01.297563 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m21:45:01.298258 [debug] [MainThread]: Partial parsing: deleted file: dbt_test://models/example/my_first_dbt_model.sql
[0m21:45:01.314252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb9805b8-c9b9-4395-8b85-561fb68b8441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05da700d0>]}
[0m21:45:01.330683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb9805b8-c9b9-4395-8b85-561fb68b8441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05db3ba60>]}
[0m21:45:01.331396 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:45:01.332131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb9805b8-c9b9-4395-8b85-561fb68b8441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05d5874f0>]}
[0m21:45:01.333962 [info ] [MainThread]: 
[0m21:45:01.335068 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:45:01.336400 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m21:45:01.353061 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m21:45:01.353775 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m21:45:01.354332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:01.376126 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:45:01.378307 [debug] [ThreadPool]: On list_dbt_db: Close
[0m21:45:01.380256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m21:45:01.390467 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:45:01.391248 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m21:45:01.391841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:45:01.398172 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:45:01.398829 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:45:01.399399 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:45:01.403887 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:45:01.405645 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m21:45:01.406322 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m21:45:01.412714 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:01.413346 [debug] [MainThread]: On master: BEGIN
[0m21:45:01.413859 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:45:01.419391 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:45:01.420006 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:01.420622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:45:01.429623 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:45:01.431214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb9805b8-c9b9-4395-8b85-561fb68b8441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05dbc6d90>]}
[0m21:45:01.431889 [debug] [MainThread]: On master: ROLLBACK
[0m21:45:01.432535 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:01.433051 [debug] [MainThread]: On master: BEGIN
[0m21:45:01.433786 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:45:01.434319 [debug] [MainThread]: On master: COMMIT
[0m21:45:01.434860 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:01.435361 [debug] [MainThread]: On master: COMMIT
[0m21:45:01.435980 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:45:01.436513 [debug] [MainThread]: On master: Close
[0m21:45:01.437485 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:45:01.438047 [info ] [MainThread]: 
[0m21:45:01.441636 [debug] [Thread-1  ]: Began running node model.dbt_test.users_model
[0m21:45:01.442418 [info ] [Thread-1  ]: 1 of 1 START sql table model public.users_model ................................ [RUN]
[0m21:45:01.443672 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.dbt_test.users_model)
[0m21:45:01.444663 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users_model
[0m21:45:01.457449 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users_model"
[0m21:45:01.458687 [debug] [Thread-1  ]: Timing info for model.dbt_test.users_model (compile): 21:45:01.445172 => 21:45:01.458305
[0m21:45:01.459322 [debug] [Thread-1  ]: Began executing node model.dbt_test.users_model
[0m21:45:01.513698 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users_model"
[0m21:45:01.514764 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:45:01.515321 [debug] [Thread-1  ]: On model.dbt_test.users_model: BEGIN
[0m21:45:01.515845 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:45:01.522230 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:45:01.522885 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:45:01.523438 [debug] [Thread-1  ]: On model.dbt_test.users_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users_model"} */

  
    

  create  table "dbt_db"."public"."users_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select id, user_name from users
  );
  
[0m21:45:01.524813 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 14: select id, user_name from users
                                   ^

[0m21:45:01.525503 [debug] [Thread-1  ]: On model.dbt_test.users_model: ROLLBACK
[0m21:45:01.526466 [debug] [Thread-1  ]: Timing info for model.dbt_test.users_model (execute): 21:45:01.459734 => 21:45:01.526128
[0m21:45:01.527058 [debug] [Thread-1  ]: On model.dbt_test.users_model: Close
[0m21:45:01.530032 [debug] [Thread-1  ]: Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 14: select id, user_name from users
                                     ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:45:01.530744 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb9805b8-c9b9-4395-8b85-561fb68b8441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05dc56dc0>]}
[0m21:45:01.531598 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.users_model ....................... [[31mERROR[0m in 0.09s]
[0m21:45:01.532494 [debug] [Thread-1  ]: Finished running node model.dbt_test.users_model
[0m21:45:01.534572 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:01.535115 [debug] [MainThread]: On master: BEGIN
[0m21:45:01.535583 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:45:01.542508 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:45:01.543160 [debug] [MainThread]: On master: COMMIT
[0m21:45:01.544230 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:01.545068 [debug] [MainThread]: On master: COMMIT
[0m21:45:01.546112 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:45:01.547070 [debug] [MainThread]: On master: Close
[0m21:45:01.548494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:01.549188 [debug] [MainThread]: Connection 'model.dbt_test.users_model' was properly closed.
[0m21:45:01.549828 [info ] [MainThread]: 
[0m21:45:01.550522 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m21:45:01.551752 [debug] [MainThread]: Command end result
[0m21:45:01.563810 [info ] [MainThread]: 
[0m21:45:01.564587 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:45:01.565191 [info ] [MainThread]: 
[0m21:45:01.565801 [error] [MainThread]:   Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 14: select id, user_name from users
                                     ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:45:01.566397 [info ] [MainThread]: 
[0m21:45:01.567048 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:45:01.569092 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.79481316, "process_user_time": 2.954201, "process_kernel_time": 0.284849, "process_mem_max_rss": "104185856", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:45:01.570138 [debug] [MainThread]: Command `dbt run` failed at 21:45:01.569911 after 0.80 seconds
[0m21:45:01.570984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05af2d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05d9f1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05dc3e790>]}
[0m21:45:01.571794 [debug] [MainThread]: Flushing usage events
[0m21:45:31.474458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04d73b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04f584e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04f5c4340>]}


============================== 21:45:31.479468 | 58f2a412-cd64-4b04-aa74-56b728fc9905 ==============================
[0m21:45:31.479468 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:45:31.480303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/amal/.dbt', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:45:31.481095 [info ] [MainThread]: dbt version: 1.7.11
[0m21:45:31.481662 [info ] [MainThread]: python version: 3.9.13
[0m21:45:31.482173 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m21:45:31.482677 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m21:45:31.597837 [info ] [MainThread]: Using profiles dir at /Users/amal/.dbt
[0m21:45:31.598621 [info ] [MainThread]: Using profiles.yml file at /Users/amal/.dbt/profiles.yml
[0m21:45:31.599240 [info ] [MainThread]: Using dbt_project.yml file at /Users/amal/Desktop/dbt/data_engineering/dbt_test/dbt_project.yml
[0m21:45:31.600074 [info ] [MainThread]: adapter type: postgres
[0m21:45:31.600681 [info ] [MainThread]: adapter version: 1.7.11
[0m21:45:31.706260 [info ] [MainThread]: Configuration:
[0m21:45:31.706979 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:45:31.707855 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:45:31.708592 [info ] [MainThread]: Required dependencies:
[0m21:45:31.709278 [debug] [MainThread]: Executing "git --help"
[0m21:45:31.720136 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:45:31.722680 [debug] [MainThread]: STDERR: "b''"
[0m21:45:31.723718 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:45:31.725058 [info ] [MainThread]: Connection:
[0m21:45:31.725777 [info ] [MainThread]:   host: localhost
[0m21:45:31.726309 [info ] [MainThread]:   port: 5432
[0m21:45:31.726834 [info ] [MainThread]:   user: amal
[0m21:45:31.727327 [info ] [MainThread]:   database: dbt_db
[0m21:45:31.727819 [info ] [MainThread]:   schema: public
[0m21:45:31.728309 [info ] [MainThread]:   connect_timeout: 10
[0m21:45:31.728807 [info ] [MainThread]:   role: None
[0m21:45:31.729328 [info ] [MainThread]:   search_path: None
[0m21:45:31.729820 [info ] [MainThread]:   keepalives_idle: 0
[0m21:45:31.730367 [info ] [MainThread]:   sslmode: None
[0m21:45:31.731042 [info ] [MainThread]:   sslcert: None
[0m21:45:31.731644 [info ] [MainThread]:   sslkey: None
[0m21:45:31.732160 [info ] [MainThread]:   sslrootcert: None
[0m21:45:31.732656 [info ] [MainThread]:   application_name: dbt
[0m21:45:31.733163 [info ] [MainThread]:   retries: 1
[0m21:45:31.733929 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:45:31.741089 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:45:31.742972 [debug] [MainThread]: Using postgres connection "debug"
[0m21:45:31.743851 [debug] [MainThread]: On debug: select 1 as id
[0m21:45:31.744616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:45:31.785876 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:45:31.788382 [debug] [MainThread]: On debug: Close
[0m21:45:31.790077 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:45:31.791657 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:45:31.794868 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.39141944, "process_user_time": 2.634407, "process_kernel_time": 0.232123, "process_mem_max_rss": "94674944", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:45:31.796211 [debug] [MainThread]: Command `dbt debug` succeeded at 21:45:31.795900 after 0.39 seconds
[0m21:45:31.797429 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:45:31.798609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04d73b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04f7d5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04f767f40>]}
[0m21:45:31.799502 [debug] [MainThread]: Flushing usage events
[0m21:45:37.567946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe847f4a040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe849da9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe849dc65e0>]}


============================== 21:45:37.572646 | 6e9ff7eb-58e4-4f41-9982-5b615c05582a ==============================
[0m21:45:37.572646 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:45:37.573630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'profiles_dir': '/Users/amal/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:45:37.856159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e9ff7eb-58e4-4f41-9982-5b615c05582a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe849db3e50>]}
[0m21:45:37.963091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e9ff7eb-58e4-4f41-9982-5b615c05582a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe849d9dd00>]}
[0m21:45:37.964097 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:45:37.987419 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:45:38.038821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:45:38.039702 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/example/users/schema.yml
[0m21:45:38.065609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9ff7eb-58e4-4f41-9982-5b615c05582a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe84a2c10d0>]}
[0m21:45:38.082823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e9ff7eb-58e4-4f41-9982-5b615c05582a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe84a1f2760>]}
[0m21:45:38.083820 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:45:38.084496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e9ff7eb-58e4-4f41-9982-5b615c05582a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe84a1f28e0>]}
[0m21:45:38.086337 [info ] [MainThread]: 
[0m21:45:38.087490 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:45:38.088799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m21:45:38.104527 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m21:45:38.105458 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m21:45:38.106055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:38.128513 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:45:38.130668 [debug] [ThreadPool]: On list_dbt_db: Close
[0m21:45:38.132608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m21:45:38.140897 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:45:38.141557 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m21:45:38.142074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:45:38.149087 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:45:38.149755 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:45:38.150330 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:45:38.154648 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:45:38.156345 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m21:45:38.157012 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m21:45:38.163253 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:38.163878 [debug] [MainThread]: On master: BEGIN
[0m21:45:38.164389 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:45:38.169780 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:45:38.170393 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:38.171000 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:45:38.179905 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:45:38.181524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e9ff7eb-58e4-4f41-9982-5b615c05582a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe84a0b24f0>]}
[0m21:45:38.182195 [debug] [MainThread]: On master: ROLLBACK
[0m21:45:38.182853 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:38.183365 [debug] [MainThread]: On master: BEGIN
[0m21:45:38.184070 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:45:38.184605 [debug] [MainThread]: On master: COMMIT
[0m21:45:38.185110 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:38.185603 [debug] [MainThread]: On master: COMMIT
[0m21:45:38.186197 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:45:38.186714 [debug] [MainThread]: On master: Close
[0m21:45:38.187674 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:45:38.188238 [info ] [MainThread]: 
[0m21:45:38.191676 [debug] [Thread-1  ]: Began running node model.dbt_test.users_model
[0m21:45:38.192468 [info ] [Thread-1  ]: 1 of 1 START sql table model public.users_model ................................ [RUN]
[0m21:45:38.193657 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.dbt_test.users_model)
[0m21:45:38.194407 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users_model
[0m21:45:38.208553 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users_model"
[0m21:45:38.210766 [debug] [Thread-1  ]: Timing info for model.dbt_test.users_model (compile): 21:45:38.194899 => 21:45:38.210046
[0m21:45:38.211590 [debug] [Thread-1  ]: Began executing node model.dbt_test.users_model
[0m21:45:38.269121 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users_model"
[0m21:45:38.270183 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:45:38.270875 [debug] [Thread-1  ]: On model.dbt_test.users_model: BEGIN
[0m21:45:38.271423 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:45:38.278105 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:45:38.278747 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:45:38.279298 [debug] [Thread-1  ]: On model.dbt_test.users_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users_model"} */

  
    

  create  table "dbt_db"."public"."users_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select id, user_name from users
  );
  
[0m21:45:38.280382 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 14: select id, user_name from users
                                   ^

[0m21:45:38.280958 [debug] [Thread-1  ]: On model.dbt_test.users_model: ROLLBACK
[0m21:45:38.281916 [debug] [Thread-1  ]: Timing info for model.dbt_test.users_model (execute): 21:45:38.212174 => 21:45:38.281588
[0m21:45:38.282497 [debug] [Thread-1  ]: On model.dbt_test.users_model: Close
[0m21:45:38.285346 [debug] [Thread-1  ]: Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 14: select id, user_name from users
                                     ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:45:38.286047 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e9ff7eb-58e4-4f41-9982-5b615c05582a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe84a3ee0d0>]}
[0m21:45:38.286894 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.users_model ....................... [[31mERROR[0m in 0.09s]
[0m21:45:38.287924 [debug] [Thread-1  ]: Finished running node model.dbt_test.users_model
[0m21:45:38.290088 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:38.290601 [debug] [MainThread]: On master: BEGIN
[0m21:45:38.291063 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:45:38.297534 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:45:38.298300 [debug] [MainThread]: On master: COMMIT
[0m21:45:38.299156 [debug] [MainThread]: Using postgres connection "master"
[0m21:45:38.300025 [debug] [MainThread]: On master: COMMIT
[0m21:45:38.301305 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:45:38.302370 [debug] [MainThread]: On master: Close
[0m21:45:38.304296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:38.305139 [debug] [MainThread]: Connection 'model.dbt_test.users_model' was properly closed.
[0m21:45:38.305982 [info ] [MainThread]: 
[0m21:45:38.306652 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m21:45:38.307834 [debug] [MainThread]: Command end result
[0m21:45:38.319956 [info ] [MainThread]: 
[0m21:45:38.320778 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:45:38.321447 [info ] [MainThread]: 
[0m21:45:38.322099 [error] [MainThread]:   Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 14: select id, user_name from users
                                     ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:45:38.322767 [info ] [MainThread]: 
[0m21:45:38.323468 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:45:38.326470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.82261467, "process_user_time": 2.939988, "process_kernel_time": 0.290929, "process_mem_max_rss": "103870464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:45:38.328210 [debug] [MainThread]: Command `dbt run` failed at 21:45:38.327878 after 0.82 seconds
[0m21:45:38.329271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe847f4a040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe84a0b2130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe84a1f2760>]}
[0m21:45:38.330159 [debug] [MainThread]: Flushing usage events
[0m21:47:48.571544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b672abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b9346b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b9386a30>]}


============================== 21:47:48.576251 | 4ba95fce-47f6-45b4-8c86-7c77fd1ec15e ==============================
[0m21:47:48.576251 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:47:48.577484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m21:47:48.578314 [info ] [MainThread]: dbt version: 1.7.11
[0m21:47:48.578899 [info ] [MainThread]: python version: 3.9.13
[0m21:47:48.579458 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m21:47:48.579978 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m21:47:48.706211 [info ] [MainThread]: Using profiles dir at /Users/amal/.dbt
[0m21:47:48.707065 [info ] [MainThread]: Using profiles.yml file at /Users/amal/.dbt/profiles.yml
[0m21:47:48.707696 [info ] [MainThread]: Using dbt_project.yml file at /Users/amal/Desktop/dbt/data_engineering/dbt_test/dbt_project.yml
[0m21:47:48.708578 [info ] [MainThread]: adapter type: postgres
[0m21:47:48.709184 [info ] [MainThread]: adapter version: 1.7.11
[0m21:47:48.816020 [info ] [MainThread]: Configuration:
[0m21:47:48.816881 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:47:48.817554 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:47:48.818183 [info ] [MainThread]: Required dependencies:
[0m21:47:48.818893 [debug] [MainThread]: Executing "git --help"
[0m21:47:48.829747 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:47:48.831821 [debug] [MainThread]: STDERR: "b''"
[0m21:47:48.832914 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:47:48.833789 [info ] [MainThread]: Connection:
[0m21:47:48.834473 [info ] [MainThread]:   host: localhost
[0m21:47:48.834980 [info ] [MainThread]:   port: 5432
[0m21:47:48.835469 [info ] [MainThread]:   user: amal
[0m21:47:48.835968 [info ] [MainThread]:   database: dbt_db
[0m21:47:48.836492 [info ] [MainThread]:   schema: public
[0m21:47:48.837027 [info ] [MainThread]:   connect_timeout: 10
[0m21:47:48.837573 [info ] [MainThread]:   role: None
[0m21:47:48.838467 [info ] [MainThread]:   search_path: None
[0m21:47:48.839296 [info ] [MainThread]:   keepalives_idle: 0
[0m21:47:48.840000 [info ] [MainThread]:   sslmode: None
[0m21:47:48.840537 [info ] [MainThread]:   sslcert: None
[0m21:47:48.841043 [info ] [MainThread]:   sslkey: None
[0m21:47:48.841538 [info ] [MainThread]:   sslrootcert: None
[0m21:47:48.842037 [info ] [MainThread]:   application_name: dbt
[0m21:47:48.842546 [info ] [MainThread]:   retries: 1
[0m21:47:48.843419 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:47:48.850110 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:47:48.851610 [debug] [MainThread]: Using postgres connection "debug"
[0m21:47:48.852274 [debug] [MainThread]: On debug: select 1 as id
[0m21:47:48.852864 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:47:48.893651 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:47:48.895845 [debug] [MainThread]: On debug: Close
[0m21:47:48.896646 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:47:48.897447 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:47:48.900261 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.39321715, "process_user_time": 2.638099, "process_kernel_time": 0.236311, "process_mem_max_rss": "96137216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:47:48.901724 [debug] [MainThread]: Command `dbt debug` succeeded at 21:47:48.901398 after 0.39 seconds
[0m21:47:48.902517 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:47:48.903526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b672abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b94ba9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b9565c10>]}
[0m21:47:48.904871 [debug] [MainThread]: Flushing usage events
[0m21:47:54.684180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe055f6abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe057c9cbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe057cc6760>]}


============================== 21:47:54.688853 | fddd4d2e-5d69-4e37-86fb-99438f6c4a8b ==============================
[0m21:47:54.688853 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:47:54.689695 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'debug': 'False', 'profiles_dir': '/Users/amal/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:47:54.986629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fddd4d2e-5d69-4e37-86fb-99438f6c4a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe057c6eb50>]}
[0m21:47:55.091625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fddd4d2e-5d69-4e37-86fb-99438f6c4a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0580f1e50>]}
[0m21:47:55.092609 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:47:55.115433 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:47:55.180610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:47:55.182396 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/example/users/schema.yml
[0m21:47:55.293670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fddd4d2e-5d69-4e37-86fb-99438f6c4a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0585240d0>]}
[0m21:47:55.310789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fddd4d2e-5d69-4e37-86fb-99438f6c4a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe058235670>]}
[0m21:47:55.311472 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:47:55.312224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fddd4d2e-5d69-4e37-86fb-99438f6c4a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe058235820>]}
[0m21:47:55.314354 [info ] [MainThread]: 
[0m21:47:55.315575 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:47:55.316817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m21:47:55.336062 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m21:47:55.336858 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m21:47:55.337384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:47:55.359701 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:47:55.362136 [debug] [ThreadPool]: On list_dbt_db: Close
[0m21:47:55.364392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m21:47:55.372511 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:47:55.373135 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m21:47:55.373628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:47:55.379569 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:47:55.380186 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:47:55.380693 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:47:55.384710 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:47:55.386302 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m21:47:55.386993 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m21:47:55.393050 [debug] [MainThread]: Using postgres connection "master"
[0m21:47:55.393630 [debug] [MainThread]: On master: BEGIN
[0m21:47:55.394100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:47:55.400516 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:47:55.401135 [debug] [MainThread]: Using postgres connection "master"
[0m21:47:55.401750 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:47:55.410885 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:47:55.412541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fddd4d2e-5d69-4e37-86fb-99438f6c4a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe05810dd60>]}
[0m21:47:55.413231 [debug] [MainThread]: On master: ROLLBACK
[0m21:47:55.413907 [debug] [MainThread]: Using postgres connection "master"
[0m21:47:55.414418 [debug] [MainThread]: On master: BEGIN
[0m21:47:55.415125 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:47:55.415659 [debug] [MainThread]: On master: COMMIT
[0m21:47:55.416168 [debug] [MainThread]: Using postgres connection "master"
[0m21:47:55.416659 [debug] [MainThread]: On master: COMMIT
[0m21:47:55.417262 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:47:55.417783 [debug] [MainThread]: On master: Close
[0m21:47:55.418759 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m21:47:55.419330 [info ] [MainThread]: 
[0m21:47:55.422650 [debug] [Thread-1  ]: Began running node model.dbt_test.users_model
[0m21:47:55.423410 [info ] [Thread-1  ]: 1 of 1 START sql table model public.users_model ................................ [RUN]
[0m21:47:55.424553 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.dbt_test.users_model)
[0m21:47:55.425347 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users_model
[0m21:47:55.439632 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users_model"
[0m21:47:55.440994 [debug] [Thread-1  ]: Timing info for model.dbt_test.users_model (compile): 21:47:55.425905 => 21:47:55.440585
[0m21:47:55.441595 [debug] [Thread-1  ]: Began executing node model.dbt_test.users_model
[0m21:47:55.494586 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users_model"
[0m21:47:55.495657 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:47:55.496213 [debug] [Thread-1  ]: On model.dbt_test.users_model: BEGIN
[0m21:47:55.496738 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:47:55.503192 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:47:55.503870 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:47:55.504443 [debug] [Thread-1  ]: On model.dbt_test.users_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users_model"} */

  
    

  create  table "dbt_db"."public"."users_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select id, user_name from users
  );
  
[0m21:47:55.505462 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 14: select id, user_name from users
                                   ^

[0m21:47:55.506042 [debug] [Thread-1  ]: On model.dbt_test.users_model: ROLLBACK
[0m21:47:55.506916 [debug] [Thread-1  ]: Timing info for model.dbt_test.users_model (execute): 21:47:55.441958 => 21:47:55.506594
[0m21:47:55.507482 [debug] [Thread-1  ]: On model.dbt_test.users_model: Close
[0m21:47:55.510459 [debug] [Thread-1  ]: Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 14: select id, user_name from users
                                     ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:47:55.511203 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fddd4d2e-5d69-4e37-86fb-99438f6c4a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0585d97c0>]}
[0m21:47:55.512044 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.users_model ....................... [[31mERROR[0m in 0.09s]
[0m21:47:55.513023 [debug] [Thread-1  ]: Finished running node model.dbt_test.users_model
[0m21:47:55.515430 [debug] [MainThread]: Using postgres connection "master"
[0m21:47:55.515931 [debug] [MainThread]: On master: BEGIN
[0m21:47:55.516391 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:47:55.523503 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:47:55.524549 [debug] [MainThread]: On master: COMMIT
[0m21:47:55.525851 [debug] [MainThread]: Using postgres connection "master"
[0m21:47:55.526790 [debug] [MainThread]: On master: COMMIT
[0m21:47:55.527966 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:47:55.529013 [debug] [MainThread]: On master: Close
[0m21:47:55.530184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:47:55.530747 [debug] [MainThread]: Connection 'model.dbt_test.users_model' was properly closed.
[0m21:47:55.531315 [info ] [MainThread]: 
[0m21:47:55.531887 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m21:47:55.532942 [debug] [MainThread]: Command end result
[0m21:47:55.546330 [info ] [MainThread]: 
[0m21:47:55.547035 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:47:55.547608 [info ] [MainThread]: 
[0m21:47:55.548154 [error] [MainThread]:   Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 14: select id, user_name from users
                                     ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:47:55.548702 [info ] [MainThread]: 
[0m21:47:55.549266 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:47:55.551031 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9407826, "process_user_time": 3.072101, "process_kernel_time": 0.296379, "process_mem_max_rss": "105684992", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:47:55.552071 [debug] [MainThread]: Command `dbt run` failed at 21:47:55.551767 after 0.94 seconds
[0m21:47:55.552856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe055f6abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe058235670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe058235850>]}
[0m21:47:55.554008 [debug] [MainThread]: Flushing usage events
[0m21:48:21.796287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb98386bb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb98532f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb985386760>]}


============================== 21:48:21.800952 | f1d4a888-ae64-494f-8867-e457a19c1be7 ==============================
[0m21:48:21.800952 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:48:21.801802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/amal/.dbt', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:48:21.802610 [info ] [MainThread]: dbt version: 1.7.11
[0m21:48:21.803204 [info ] [MainThread]: python version: 3.9.13
[0m21:48:21.803724 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m21:48:21.804241 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m21:48:21.923238 [info ] [MainThread]: Using profiles dir at /Users/amal/.dbt
[0m21:48:21.924078 [info ] [MainThread]: Using profiles.yml file at /Users/amal/.dbt/profiles.yml
[0m21:48:21.924698 [info ] [MainThread]: Using dbt_project.yml file at /Users/amal/Desktop/dbt/data_engineering/dbt_test/dbt_project.yml
[0m21:48:21.925714 [info ] [MainThread]: adapter type: postgres
[0m21:48:21.926505 [info ] [MainThread]: adapter version: 1.7.11
[0m21:48:22.033574 [info ] [MainThread]: Configuration:
[0m21:48:22.034408 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:48:22.035008 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:48:22.035641 [info ] [MainThread]: Required dependencies:
[0m21:48:22.036314 [debug] [MainThread]: Executing "git --help"
[0m21:48:22.046388 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:48:22.048129 [debug] [MainThread]: STDERR: "b''"
[0m21:48:22.049220 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:48:22.050179 [info ] [MainThread]: Connection:
[0m21:48:22.051164 [info ] [MainThread]:   host: localhost
[0m21:48:22.051870 [info ] [MainThread]:   port: 5432
[0m21:48:22.052428 [info ] [MainThread]:   user: amal
[0m21:48:22.053164 [info ] [MainThread]:   database: dbt_db
[0m21:48:22.053848 [info ] [MainThread]:   schema: public
[0m21:48:22.055057 [info ] [MainThread]:   connect_timeout: 10
[0m21:48:22.056393 [info ] [MainThread]:   role: None
[0m21:48:22.057370 [info ] [MainThread]:   search_path: None
[0m21:48:22.058120 [info ] [MainThread]:   keepalives_idle: 0
[0m21:48:22.058750 [info ] [MainThread]:   sslmode: None
[0m21:48:22.059495 [info ] [MainThread]:   sslcert: None
[0m21:48:22.060337 [info ] [MainThread]:   sslkey: None
[0m21:48:22.061104 [info ] [MainThread]:   sslrootcert: None
[0m21:48:22.061797 [info ] [MainThread]:   application_name: dbt
[0m21:48:22.062401 [info ] [MainThread]:   retries: 1
[0m21:48:22.063317 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:48:22.069058 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:48:22.070811 [debug] [MainThread]: Using postgres connection "debug"
[0m21:48:22.071858 [debug] [MainThread]: On debug: select 1 as id
[0m21:48:22.072676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:22.115746 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:48:22.118008 [debug] [MainThread]: On debug: Close
[0m21:48:22.118822 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:48:22.119556 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:48:22.122022 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.39042607, "process_user_time": 2.629098, "process_kernel_time": 0.230348, "process_mem_max_rss": "94806016", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:48:22.123240 [debug] [MainThread]: Command `dbt debug` succeeded at 21:48:22.122967 after 0.39 seconds
[0m21:48:22.124021 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:48:22.124823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb98386bb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb98536c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb985667b50>]}
[0m21:48:22.125976 [debug] [MainThread]: Flushing usage events
[0m21:48:28.238673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb263f2a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb265c9d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb265cc6220>]}


============================== 21:48:28.243150 | 567661ee-e065-4c96-ba0c-845fcdbb432e ==============================
[0m21:48:28.243150 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:48:28.244012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:48:28.591819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '567661ee-e065-4c96-ba0c-845fcdbb432e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb264989f40>]}
[0m21:48:28.698085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '567661ee-e065-4c96-ba0c-845fcdbb432e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb265e9da30>]}
[0m21:48:28.699056 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:48:28.721930 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:48:28.735026 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:48:28.735835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '567661ee-e065-4c96-ba0c-845fcdbb432e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb266095c40>]}
[0m21:48:29.936984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '567661ee-e065-4c96-ba0c-845fcdbb432e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2666220d0>]}
[0m21:48:29.953389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '567661ee-e065-4c96-ba0c-845fcdbb432e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26616aeb0>]}
[0m21:48:29.954052 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:48:29.954793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '567661ee-e065-4c96-ba0c-845fcdbb432e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2660e3730>]}
[0m21:48:29.956680 [info ] [MainThread]: 
[0m21:48:29.957874 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:48:29.959055 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m21:48:29.977379 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m21:48:29.978012 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m21:48:29.978499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:29.999950 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:48:30.002107 [debug] [ThreadPool]: On list_dbt_db: Close
[0m21:48:30.004432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m21:48:30.012416 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:48:30.013037 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m21:48:30.013514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:48:30.019040 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:48:30.019651 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:48:30.020205 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:48:30.024368 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:48:30.026048 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m21:48:30.026707 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m21:48:30.032560 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:30.033132 [debug] [MainThread]: On master: BEGIN
[0m21:48:30.033598 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:30.039859 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:48:30.040432 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:30.041018 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:48:30.049940 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:48:30.051510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '567661ee-e065-4c96-ba0c-845fcdbb432e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2664642b0>]}
[0m21:48:30.052180 [debug] [MainThread]: On master: ROLLBACK
[0m21:48:30.052822 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:30.053328 [debug] [MainThread]: On master: BEGIN
[0m21:48:30.054065 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:48:30.054590 [debug] [MainThread]: On master: COMMIT
[0m21:48:30.055105 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:30.055584 [debug] [MainThread]: On master: COMMIT
[0m21:48:30.056200 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:48:30.056702 [debug] [MainThread]: On master: Close
[0m21:48:30.057693 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:48:30.058369 [info ] [MainThread]: 
[0m21:48:30.061208 [debug] [Thread-1  ]: Began running node model.dbt_test.users_model
[0m21:48:30.061972 [info ] [Thread-1  ]: 1 of 1 START sql table model public.users_model ................................ [RUN]
[0m21:48:30.063100 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.dbt_test.users_model)
[0m21:48:30.063661 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users_model
[0m21:48:30.077118 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users_model"
[0m21:48:30.078877 [debug] [Thread-1  ]: Timing info for model.dbt_test.users_model (compile): 21:48:30.064017 => 21:48:30.078288
[0m21:48:30.080026 [debug] [Thread-1  ]: Began executing node model.dbt_test.users_model
[0m21:48:30.134002 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users_model"
[0m21:48:30.135081 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:48:30.135640 [debug] [Thread-1  ]: On model.dbt_test.users_model: BEGIN
[0m21:48:30.136165 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:48:30.142852 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:48:30.143541 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:48:30.144122 [debug] [Thread-1  ]: On model.dbt_test.users_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users_model"} */

  
    

  create  table "dbt_db"."public"."users_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select id, user_name from users
  );
  
[0m21:48:30.145198 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 14: select id, user_name from users
                                   ^

[0m21:48:30.145807 [debug] [Thread-1  ]: On model.dbt_test.users_model: ROLLBACK
[0m21:48:30.146765 [debug] [Thread-1  ]: Timing info for model.dbt_test.users_model (execute): 21:48:30.080429 => 21:48:30.146421
[0m21:48:30.147376 [debug] [Thread-1  ]: On model.dbt_test.users_model: Close
[0m21:48:30.150246 [debug] [Thread-1  ]: Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 14: select id, user_name from users
                                     ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:48:30.151223 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '567661ee-e065-4c96-ba0c-845fcdbb432e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2666225b0>]}
[0m21:48:30.152218 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.users_model ....................... [[31mERROR[0m in 0.09s]
[0m21:48:30.153231 [debug] [Thread-1  ]: Finished running node model.dbt_test.users_model
[0m21:48:30.155352 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:30.155912 [debug] [MainThread]: On master: BEGIN
[0m21:48:30.156379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:48:30.163317 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:48:30.164336 [debug] [MainThread]: On master: COMMIT
[0m21:48:30.165439 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:30.166296 [debug] [MainThread]: On master: COMMIT
[0m21:48:30.167422 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:48:30.168503 [debug] [MainThread]: On master: Close
[0m21:48:30.169957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:30.170574 [debug] [MainThread]: Connection 'model.dbt_test.users_model' was properly closed.
[0m21:48:30.171228 [info ] [MainThread]: 
[0m21:48:30.171923 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m21:48:30.173131 [debug] [MainThread]: Command end result
[0m21:48:30.182736 [info ] [MainThread]: 
[0m21:48:30.183852 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:48:30.184979 [info ] [MainThread]: 
[0m21:48:30.185639 [error] [MainThread]:   Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 14: select id, user_name from users
                                     ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:48:30.186491 [info ] [MainThread]: 
[0m21:48:30.187438 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:48:30.189843 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0159636, "process_user_time": 4.099704, "process_kernel_time": 0.29718, "process_mem_max_rss": "108658688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:48:30.191155 [debug] [MainThread]: Command `dbt run` failed at 21:48:30.190836 after 2.02 seconds
[0m21:48:30.191799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb263f2a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2660f1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb265e9da30>]}
[0m21:48:30.192426 [debug] [MainThread]: Flushing usage events
[0m21:54:14.908968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f872abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92fad84b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92fadc4a30>]}


============================== 21:54:14.913755 | 53219c45-f2cc-4ba8-abaa-815da0e9fb11 ==============================
[0m21:54:14.913755 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:54:14.914612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:54:14.915415 [info ] [MainThread]: dbt version: 1.7.11
[0m21:54:14.915987 [info ] [MainThread]: python version: 3.9.13
[0m21:54:14.916505 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m21:54:14.917065 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m21:54:15.044965 [info ] [MainThread]: Using profiles dir at /Users/amal/.dbt
[0m21:54:15.045865 [info ] [MainThread]: Using profiles.yml file at /Users/amal/.dbt/profiles.yml
[0m21:54:15.046562 [info ] [MainThread]: Using dbt_project.yml file at /Users/amal/Desktop/dbt/data_engineering/dbt_test/dbt_project.yml
[0m21:54:15.047348 [info ] [MainThread]: adapter type: postgres
[0m21:54:15.047879 [info ] [MainThread]: adapter version: 1.7.11
[0m21:54:15.152935 [info ] [MainThread]: Configuration:
[0m21:54:15.153659 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:54:15.154203 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:54:15.154760 [info ] [MainThread]: Required dependencies:
[0m21:54:15.155357 [debug] [MainThread]: Executing "git --help"
[0m21:54:15.166107 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:54:15.167709 [debug] [MainThread]: STDERR: "b''"
[0m21:54:15.169185 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:54:15.170441 [info ] [MainThread]: Connection:
[0m21:54:15.171495 [info ] [MainThread]:   host: localhost
[0m21:54:15.172231 [info ] [MainThread]:   port: 5432
[0m21:54:15.172954 [info ] [MainThread]:   user: amal
[0m21:54:15.173644 [info ] [MainThread]:   database: dbt_db
[0m21:54:15.174207 [info ] [MainThread]:   schema: public
[0m21:54:15.174724 [info ] [MainThread]:   connect_timeout: 10
[0m21:54:15.175306 [info ] [MainThread]:   role: None
[0m21:54:15.176295 [info ] [MainThread]:   search_path: None
[0m21:54:15.176971 [info ] [MainThread]:   keepalives_idle: 0
[0m21:54:15.177504 [info ] [MainThread]:   sslmode: None
[0m21:54:15.178022 [info ] [MainThread]:   sslcert: None
[0m21:54:15.178536 [info ] [MainThread]:   sslkey: None
[0m21:54:15.179050 [info ] [MainThread]:   sslrootcert: None
[0m21:54:15.179580 [info ] [MainThread]:   application_name: dbt
[0m21:54:15.180322 [info ] [MainThread]:   retries: 1
[0m21:54:15.181798 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:54:15.194646 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:54:15.196809 [debug] [MainThread]: Using postgres connection "debug"
[0m21:54:15.197982 [debug] [MainThread]: On debug: select 1 as id
[0m21:54:15.199040 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:15.239269 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:54:15.241697 [debug] [MainThread]: On debug: Close
[0m21:54:15.242541 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:54:15.243355 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:54:15.246154 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.402198, "process_user_time": 2.6308, "process_kernel_time": 0.239853, "process_mem_max_rss": "95125504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:54:15.247313 [debug] [MainThread]: Command `dbt debug` succeeded at 21:54:15.247045 after 0.40 seconds
[0m21:54:15.248093 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:54:15.248810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f872abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92fad84640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92faed3fd0>]}
[0m21:54:15.249851 [debug] [MainThread]: Flushing usage events
[0m21:54:21.842707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f71e0eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f73b3daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f73b676a0>]}


============================== 21:54:21.847675 | b0d7cc42-04d8-4b8d-9ae7-12d4a6da9411 ==============================
[0m21:54:21.847675 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:54:21.848526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:54:22.416891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0d7cc42-04d8-4b8d-9ae7-12d4a6da9411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f73b0fb50>]}
[0m21:54:22.523281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0d7cc42-04d8-4b8d-9ae7-12d4a6da9411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f73cddd90>]}
[0m21:54:22.524327 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:54:22.546815 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:54:22.600831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:54:22.601426 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:54:22.608904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0d7cc42-04d8-4b8d-9ae7-12d4a6da9411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f740df0d0>]}
[0m21:54:22.627845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0d7cc42-04d8-4b8d-9ae7-12d4a6da9411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f741af5e0>]}
[0m21:54:22.628696 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:54:22.629382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0d7cc42-04d8-4b8d-9ae7-12d4a6da9411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f741af790>]}
[0m21:54:22.631367 [info ] [MainThread]: 
[0m21:54:22.632438 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:54:22.633825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m21:54:22.650334 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m21:54:22.651031 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m21:54:22.651571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:22.674504 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:54:22.677191 [debug] [ThreadPool]: On list_dbt_db: Close
[0m21:54:22.679921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m21:54:22.688658 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:54:22.689307 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m21:54:22.689851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:54:22.696320 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:54:22.696982 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:54:22.697571 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:54:22.701837 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:54:22.703525 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m21:54:22.704182 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m21:54:22.710693 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:22.711332 [debug] [MainThread]: On master: BEGIN
[0m21:54:22.711843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:22.717699 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:54:22.718335 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:22.718966 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:54:22.727852 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:54:22.729490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0d7cc42-04d8-4b8d-9ae7-12d4a6da9411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f7436ceb0>]}
[0m21:54:22.730189 [debug] [MainThread]: On master: ROLLBACK
[0m21:54:22.730855 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:22.731362 [debug] [MainThread]: On master: BEGIN
[0m21:54:22.732071 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:54:22.732599 [debug] [MainThread]: On master: COMMIT
[0m21:54:22.733106 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:22.733608 [debug] [MainThread]: On master: COMMIT
[0m21:54:22.734209 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:54:22.734728 [debug] [MainThread]: On master: Close
[0m21:54:22.735709 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:54:22.736271 [info ] [MainThread]: 
[0m21:54:22.748239 [debug] [Thread-1  ]: Began running node model.dbt_test.users_model
[0m21:54:22.749337 [info ] [Thread-1  ]: 1 of 1 START sql table model public.users_model ................................ [RUN]
[0m21:54:22.750511 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.dbt_test.users_model)
[0m21:54:22.751384 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users_model
[0m21:54:22.767646 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users_model"
[0m21:54:22.769029 [debug] [Thread-1  ]: Timing info for model.dbt_test.users_model (compile): 21:54:22.751940 => 21:54:22.768601
[0m21:54:22.769715 [debug] [Thread-1  ]: Began executing node model.dbt_test.users_model
[0m21:54:22.839063 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users_model"
[0m21:54:22.840335 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:54:22.840952 [debug] [Thread-1  ]: On model.dbt_test.users_model: BEGIN
[0m21:54:22.841549 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:54:22.848327 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:54:22.849110 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:54:22.849712 [debug] [Thread-1  ]: On model.dbt_test.users_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users_model"} */

  
    

  create  table "dbt_db"."public"."users_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select id, user_name from users
  );
  
[0m21:54:22.850993 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 14: select id, user_name from users
                                   ^

[0m21:54:22.851766 [debug] [Thread-1  ]: On model.dbt_test.users_model: ROLLBACK
[0m21:54:22.852868 [debug] [Thread-1  ]: Timing info for model.dbt_test.users_model (execute): 21:54:22.770141 => 21:54:22.852516
[0m21:54:22.853466 [debug] [Thread-1  ]: On model.dbt_test.users_model: Close
[0m21:54:22.856500 [debug] [Thread-1  ]: Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 14: select id, user_name from users
                                     ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:54:22.857310 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0d7cc42-04d8-4b8d-9ae7-12d4a6da9411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f743725b0>]}
[0m21:54:22.858250 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.users_model ....................... [[31mERROR[0m in 0.11s]
[0m21:54:22.859214 [debug] [Thread-1  ]: Finished running node model.dbt_test.users_model
[0m21:54:22.861344 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:22.861961 [debug] [MainThread]: On master: BEGIN
[0m21:54:22.862451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:54:22.869222 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:54:22.870004 [debug] [MainThread]: On master: COMMIT
[0m21:54:22.871294 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:22.872774 [debug] [MainThread]: On master: COMMIT
[0m21:54:22.874352 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:54:22.875475 [debug] [MainThread]: On master: Close
[0m21:54:22.876775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:22.877389 [debug] [MainThread]: Connection 'model.dbt_test.users_model' was properly closed.
[0m21:54:22.878017 [info ] [MainThread]: 
[0m21:54:22.878661 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m21:54:22.879750 [debug] [MainThread]: Command end result
[0m21:54:22.894088 [info ] [MainThread]: 
[0m21:54:22.894874 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:54:22.895492 [info ] [MainThread]: 
[0m21:54:22.896122 [error] [MainThread]:   Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 14: select id, user_name from users
                                     ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:54:22.896928 [info ] [MainThread]: 
[0m21:54:22.897646 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:54:22.900153 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1230663, "process_user_time": 3.022668, "process_kernel_time": 0.369935, "process_mem_max_rss": "103702528", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:54:22.901664 [debug] [MainThread]: Command `dbt run` failed at 21:54:22.901366 after 1.12 seconds
[0m21:54:22.902486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f71e0eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f742436d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f73cdd400>]}
[0m21:54:22.903259 [debug] [MainThread]: Flushing usage events
[0m21:55:31.627570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9696e2a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9698c85e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9698cc5b20>]}


============================== 21:55:31.632317 | 6d290f59-c7d4-4c28-9d5f-7ed957cd9b94 ==============================
[0m21:55:31.632317 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:55:31.633194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:55:31.633983 [info ] [MainThread]: dbt version: 1.7.11
[0m21:55:31.634520 [info ] [MainThread]: python version: 3.9.13
[0m21:55:31.635035 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m21:55:31.635544 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m21:55:31.754070 [info ] [MainThread]: Using profiles dir at /Users/amal/.dbt
[0m21:55:31.754945 [info ] [MainThread]: Using profiles.yml file at /Users/amal/.dbt/profiles.yml
[0m21:55:31.755600 [info ] [MainThread]: Using dbt_project.yml file at /Users/amal/Desktop/dbt/data_engineering/dbt_test/dbt_project.yml
[0m21:55:31.756479 [info ] [MainThread]: adapter type: postgres
[0m21:55:31.757113 [info ] [MainThread]: adapter version: 1.7.11
[0m21:55:31.862425 [info ] [MainThread]: Configuration:
[0m21:55:31.863217 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:55:31.863858 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:55:31.864461 [info ] [MainThread]: Required dependencies:
[0m21:55:31.865135 [debug] [MainThread]: Executing "git --help"
[0m21:55:31.875448 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:55:31.877582 [debug] [MainThread]: STDERR: "b''"
[0m21:55:31.878534 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:55:31.879380 [info ] [MainThread]: Connection:
[0m21:55:31.880460 [info ] [MainThread]:   host: localhost
[0m21:55:31.881062 [info ] [MainThread]:   port: 5432
[0m21:55:31.881575 [info ] [MainThread]:   user: amal
[0m21:55:31.882073 [info ] [MainThread]:   database: dbt_db
[0m21:55:31.882572 [info ] [MainThread]:   schema: public
[0m21:55:31.883069 [info ] [MainThread]:   connect_timeout: 10
[0m21:55:31.883563 [info ] [MainThread]:   role: None
[0m21:55:31.884056 [info ] [MainThread]:   search_path: None
[0m21:55:31.884547 [info ] [MainThread]:   keepalives_idle: 0
[0m21:55:31.885107 [info ] [MainThread]:   sslmode: None
[0m21:55:31.885626 [info ] [MainThread]:   sslcert: None
[0m21:55:31.886115 [info ] [MainThread]:   sslkey: None
[0m21:55:31.886799 [info ] [MainThread]:   sslrootcert: None
[0m21:55:31.887402 [info ] [MainThread]:   application_name: dbt
[0m21:55:31.887913 [info ] [MainThread]:   retries: 1
[0m21:55:31.888748 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:55:31.895850 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:55:31.898145 [debug] [MainThread]: Using postgres connection "debug"
[0m21:55:31.899179 [debug] [MainThread]: On debug: select 1 as id
[0m21:55:31.900207 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:55:31.944780 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:55:31.947003 [debug] [MainThread]: On debug: Close
[0m21:55:31.947979 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:55:31.948795 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:55:31.951377 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.39097765, "process_user_time": 2.654617, "process_kernel_time": 0.239434, "process_mem_max_rss": "95358976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:55:31.952545 [debug] [MainThread]: Command `dbt debug` succeeded at 21:55:31.952275 after 0.39 seconds
[0m21:55:31.953297 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:55:31.954036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9696e2a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9698cc0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9698e7d040>]}
[0m21:55:31.954845 [debug] [MainThread]: Flushing usage events
[0m21:55:37.110957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a873cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8aad9caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8aadc66a0>]}


============================== 21:55:37.115642 | 7bba56a4-6038-4e67-a7bb-7e42c5c7d6e2 ==============================
[0m21:55:37.115642 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:55:37.116427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'profiles_dir': '/Users/amal/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:55:37.383721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bba56a4-6038-4e67-a7bb-7e42c5c7d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8aad6eb50>]}
[0m21:55:37.579869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bba56a4-6038-4e67-a7bb-7e42c5c7d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8aaf3cd90>]}
[0m21:55:37.581016 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m21:55:37.602316 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:55:37.650794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:55:37.651773 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/example/users/users_model.sql
[0m21:55:37.825364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bba56a4-6038-4e67-a7bb-7e42c5c7d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab3cd0d0>]}
[0m21:55:37.842572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bba56a4-6038-4e67-a7bb-7e42c5c7d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab1f06a0>]}
[0m21:55:37.843299 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:55:37.844089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bba56a4-6038-4e67-a7bb-7e42c5c7d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab1f0820>]}
[0m21:55:37.845995 [info ] [MainThread]: 
[0m21:55:37.847101 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:55:37.848425 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m21:55:37.865999 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m21:55:37.866708 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m21:55:37.867281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:37.890180 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:55:37.892654 [debug] [ThreadPool]: On list_dbt_db: Close
[0m21:55:37.895197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m21:55:37.904311 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:55:37.905010 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m21:55:37.905644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:37.912256 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:55:37.912986 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m21:55:37.913583 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:55:37.917986 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:55:37.919832 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m21:55:37.920533 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m21:55:37.927132 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:37.927801 [debug] [MainThread]: On master: BEGIN
[0m21:55:37.928334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:55:37.934257 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:55:37.934879 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:37.935500 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:55:37.944417 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:55:37.945972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bba56a4-6038-4e67-a7bb-7e42c5c7d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab417730>]}
[0m21:55:37.946667 [debug] [MainThread]: On master: ROLLBACK
[0m21:55:37.947362 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:37.947897 [debug] [MainThread]: On master: BEGIN
[0m21:55:37.948643 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:55:37.949182 [debug] [MainThread]: On master: COMMIT
[0m21:55:37.949688 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:37.950177 [debug] [MainThread]: On master: COMMIT
[0m21:55:37.950756 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:55:37.951259 [debug] [MainThread]: On master: Close
[0m21:55:37.952222 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:55:37.952892 [info ] [MainThread]: 
[0m21:55:37.955703 [debug] [Thread-1  ]: Began running node model.dbt_test.users_model
[0m21:55:37.956475 [info ] [Thread-1  ]: 1 of 1 START sql view model public.users_model ................................. [RUN]
[0m21:55:37.957495 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.dbt_test.users_model)
[0m21:55:37.958071 [debug] [Thread-1  ]: Began compiling node model.dbt_test.users_model
[0m21:55:37.968259 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.users_model"
[0m21:55:37.969736 [debug] [Thread-1  ]: Timing info for model.dbt_test.users_model (compile): 21:55:37.958427 => 21:55:37.969285
[0m21:55:37.970424 [debug] [Thread-1  ]: Began executing node model.dbt_test.users_model
[0m21:55:38.024002 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.users_model"
[0m21:55:38.025327 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:55:38.026763 [debug] [Thread-1  ]: On model.dbt_test.users_model: BEGIN
[0m21:55:38.028062 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:55:38.036659 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:55:38.037629 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.users_model"
[0m21:55:38.038590 [debug] [Thread-1  ]: On model.dbt_test.users_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users_model"} */

  create view "dbt_db"."public"."users_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models
select id, user_name from users
  );
[0m21:55:38.040461 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 8: select id, user_name from users
                                  ^

[0m21:55:38.041709 [debug] [Thread-1  ]: On model.dbt_test.users_model: ROLLBACK
[0m21:55:38.043713 [debug] [Thread-1  ]: Timing info for model.dbt_test.users_model (execute): 21:55:37.970849 => 21:55:38.043012
[0m21:55:38.045157 [debug] [Thread-1  ]: On model.dbt_test.users_model: Close
[0m21:55:38.050272 [debug] [Thread-1  ]: Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 8: select id, user_name from users
                                    ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:55:38.051486 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bba56a4-6038-4e67-a7bb-7e42c5c7d6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab6073a0>]}
[0m21:55:38.053013 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.users_model ........................ [[31mERROR[0m in 0.09s]
[0m21:55:38.054404 [debug] [Thread-1  ]: Finished running node model.dbt_test.users_model
[0m21:55:38.056943 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:38.057695 [debug] [MainThread]: On master: BEGIN
[0m21:55:38.058304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:55:38.065885 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:55:38.067140 [debug] [MainThread]: On master: COMMIT
[0m21:55:38.068125 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:38.069170 [debug] [MainThread]: On master: COMMIT
[0m21:55:38.071059 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:55:38.072402 [debug] [MainThread]: On master: Close
[0m21:55:38.074035 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:38.074971 [debug] [MainThread]: Connection 'model.dbt_test.users_model' was properly closed.
[0m21:55:38.075727 [info ] [MainThread]: 
[0m21:55:38.076447 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m21:55:38.078256 [debug] [MainThread]: Command end result
[0m21:55:38.093428 [info ] [MainThread]: 
[0m21:55:38.094291 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:55:38.095181 [info ] [MainThread]: 
[0m21:55:38.096626 [error] [MainThread]:   Database Error in model users_model (models/example/users/users_model.sql)
  relation "users" does not exist
  LINE 8: select id, user_name from users
                                    ^
  compiled Code at target/run/dbt_test/models/example/users/users_model.sql
[0m21:55:38.097752 [info ] [MainThread]: 
[0m21:55:38.099400 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:55:38.102348 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.057539, "process_user_time": 3.121865, "process_kernel_time": 0.288615, "process_mem_max_rss": "106221568", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:55:38.103501 [debug] [MainThread]: Command `dbt run` failed at 21:55:38.103237 after 1.06 seconds
[0m21:55:38.104537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a873cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8aaf7fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8aad6eb50>]}
[0m21:55:38.105367 [debug] [MainThread]: Flushing usage events
[0m22:03:02.101311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefeaf49040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefedb46b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefedb86a30>]}


============================== 22:03:02.106174 | 126280fa-c7ea-4f4a-80fe-e58a3cfeaa4f ==============================
[0m22:03:02.106174 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:03:02.107012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:03:02.107817 [info ] [MainThread]: dbt version: 1.7.11
[0m22:03:02.108398 [info ] [MainThread]: python version: 3.9.13
[0m22:03:02.108915 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m22:03:02.109470 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m22:03:02.234372 [info ] [MainThread]: Using profiles dir at /Users/amal/.dbt
[0m22:03:02.235299 [info ] [MainThread]: Using profiles.yml file at /Users/amal/.dbt/profiles.yml
[0m22:03:02.235977 [info ] [MainThread]: Using dbt_project.yml file at /Users/amal/Desktop/dbt/data_engineering/dbt_test/dbt_project.yml
[0m22:03:02.236823 [info ] [MainThread]: adapter type: postgres
[0m22:03:02.237478 [info ] [MainThread]: adapter version: 1.7.11
[0m22:03:02.342634 [info ] [MainThread]: Configuration:
[0m22:03:02.343482 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:03:02.344080 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:03:02.344696 [info ] [MainThread]: Required dependencies:
[0m22:03:02.345381 [debug] [MainThread]: Executing "git --help"
[0m22:03:02.361479 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:03:02.362700 [debug] [MainThread]: STDERR: "b''"
[0m22:03:02.363516 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:03:02.364699 [info ] [MainThread]: Connection:
[0m22:03:02.365490 [info ] [MainThread]:   host: localhost
[0m22:03:02.366054 [info ] [MainThread]:   port: 5432
[0m22:03:02.366603 [info ] [MainThread]:   user: amal
[0m22:03:02.367152 [info ] [MainThread]:   database: dbt_db
[0m22:03:02.367685 [info ] [MainThread]:   schema: public
[0m22:03:02.368219 [info ] [MainThread]:   connect_timeout: 10
[0m22:03:02.368753 [info ] [MainThread]:   role: None
[0m22:03:02.369346 [info ] [MainThread]:   search_path: None
[0m22:03:02.369919 [info ] [MainThread]:   keepalives_idle: 0
[0m22:03:02.370458 [info ] [MainThread]:   sslmode: None
[0m22:03:02.371002 [info ] [MainThread]:   sslcert: None
[0m22:03:02.371515 [info ] [MainThread]:   sslkey: None
[0m22:03:02.372027 [info ] [MainThread]:   sslrootcert: None
[0m22:03:02.372542 [info ] [MainThread]:   application_name: dbt
[0m22:03:02.373055 [info ] [MainThread]:   retries: 1
[0m22:03:02.373853 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m22:03:02.381142 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:03:02.383217 [debug] [MainThread]: Using postgres connection "debug"
[0m22:03:02.383952 [debug] [MainThread]: On debug: select 1 as id
[0m22:03:02.384577 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:03:02.431595 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:03:02.434084 [debug] [MainThread]: On debug: Close
[0m22:03:02.435291 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:03:02.436170 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:03:02.452291 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.42887232, "process_user_time": 2.877078, "process_kernel_time": 0.506306, "process_mem_max_rss": "95318016", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:03:02.461056 [debug] [MainThread]: Command `dbt debug` succeeded at 22:03:02.453792 after 0.43 seconds
[0m22:03:02.462004 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:03:02.462940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefeaf49040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefedb2eee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefedc15400>]}
[0m22:03:02.464187 [debug] [MainThread]: Flushing usage events
[0m22:03:09.150637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c652a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c8b7dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c8ba7d30>]}


============================== 22:03:09.157208 | 739b9498-7802-46f9-8633-a7967dac5bea ==============================
[0m22:03:09.157208 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:03:09.158529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:03:09.538149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '739b9498-7802-46f9-8633-a7967dac5bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c8b68e50>]}
[0m22:03:09.659005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '739b9498-7802-46f9-8633-a7967dac5bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c8d1e2e0>]}
[0m22:03:09.660051 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m22:03:09.683843 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:03:09.732846 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 0 files changed.
[0m22:03:09.733627 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/example/my_second_dbt_model.sql
[0m22:03:09.734170 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/example/my_first_dbt_model.sql
[0m22:03:09.734755 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/example/schema.yml
[0m22:03:09.735292 [debug] [MainThread]: Partial parsing: deleted file: dbt_test://models/example/users/users_model.sql
[0m22:03:10.100523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '739b9498-7802-46f9-8633-a7967dac5bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c95680d0>]}
[0m22:03:10.120547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '739b9498-7802-46f9-8633-a7967dac5bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c90f17c0>]}
[0m22:03:10.121281 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m22:03:10.121877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '739b9498-7802-46f9-8633-a7967dac5bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c90f1970>]}
[0m22:03:10.123871 [info ] [MainThread]: 
[0m22:03:10.124928 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:03:10.126315 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m22:03:10.142070 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m22:03:10.142788 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m22:03:10.143342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:10.167205 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m22:03:10.169556 [debug] [ThreadPool]: On list_dbt_db: Close
[0m22:03:10.171806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m22:03:10.181079 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m22:03:10.181796 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m22:03:10.182436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:10.189585 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:03:10.190248 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m22:03:10.190831 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:03:10.195261 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m22:03:10.197052 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m22:03:10.197922 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m22:03:10.205446 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:10.206105 [debug] [MainThread]: On master: BEGIN
[0m22:03:10.206627 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:03:10.212560 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:03:10.213185 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:10.213809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:03:10.223089 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:03:10.224753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '739b9498-7802-46f9-8633-a7967dac5bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c8f91880>]}
[0m22:03:10.225457 [debug] [MainThread]: On master: ROLLBACK
[0m22:03:10.226109 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:10.226617 [debug] [MainThread]: On master: BEGIN
[0m22:03:10.227338 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:03:10.227867 [debug] [MainThread]: On master: COMMIT
[0m22:03:10.228370 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:10.228859 [debug] [MainThread]: On master: COMMIT
[0m22:03:10.229471 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:03:10.229997 [debug] [MainThread]: On master: Close
[0m22:03:10.231105 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:03:10.231760 [info ] [MainThread]: 
[0m22:03:10.234682 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m22:03:10.235495 [info ] [Thread-1  ]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m22:03:10.236613 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.dbt_test.my_first_dbt_model)
[0m22:03:10.237399 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m22:03:10.250395 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m22:03:10.252796 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (compile): 22:03:10.237854 => 22:03:10.252083
[0m22:03:10.253799 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m22:03:10.323179 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m22:03:10.324319 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m22:03:10.324980 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m22:03:10.325626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:03:10.331895 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m22:03:10.332592 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m22:03:10.333194 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m22:03:10.378219 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m22:03:10.389007 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m22:03:10.389799 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m22:03:10.390879 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:03:10.395975 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m22:03:10.396723 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m22:03:10.397903 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:03:10.424702 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m22:03:10.425404 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m22:03:10.425945 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m22:03:10.427755 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m22:03:10.497732 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."my_first_dbt_model__dbt_backup"
[0m22:03:10.506591 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m22:03:10.507475 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m22:03:10.513456 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:03:10.516704 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (execute): 22:03:10.254469 => 22:03:10.516286
[0m22:03:10.517547 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: Close
[0m22:03:10.518970 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '739b9498-7802-46f9-8633-a7967dac5bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c97cf160>]}
[0m22:03:10.520672 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.28s]
[0m22:03:10.521895 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m22:03:10.523556 [debug] [Thread-3  ]: Began running node model.dbt_test.my_second_dbt_model
[0m22:03:10.524723 [info ] [Thread-3  ]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m22:03:10.526295 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_test.my_second_dbt_model'
[0m22:03:10.527369 [debug] [Thread-3  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m22:03:10.534135 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m22:03:10.535948 [debug] [Thread-3  ]: Timing info for model.dbt_test.my_second_dbt_model (compile): 22:03:10.528165 => 22:03:10.535377
[0m22:03:10.536973 [debug] [Thread-3  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m22:03:10.576964 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m22:03:10.578445 [debug] [Thread-3  ]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m22:03:10.579176 [debug] [Thread-3  ]: On model.dbt_test.my_second_dbt_model: BEGIN
[0m22:03:10.579952 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:03:10.589874 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m22:03:10.590929 [debug] [Thread-3  ]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m22:03:10.592065 [debug] [Thread-3  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dbt_db"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m22:03:10.816918 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:03:10.822774 [debug] [Thread-3  ]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m22:03:10.823545 [debug] [Thread-3  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dbt_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m22:03:10.824680 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:03:10.827524 [debug] [Thread-3  ]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m22:03:10.828310 [debug] [Thread-3  ]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m22:03:10.829048 [debug] [Thread-3  ]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m22:03:10.830528 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m22:03:10.835426 [debug] [Thread-3  ]: Applying DROP to: "dbt_db"."public"."my_second_dbt_model__dbt_backup"
[0m22:03:10.840004 [debug] [Thread-3  ]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m22:03:10.840782 [debug] [Thread-3  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dbt_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m22:03:10.841787 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m22:03:10.844201 [debug] [Thread-3  ]: Timing info for model.dbt_test.my_second_dbt_model (execute): 22:03:10.537622 => 22:03:10.843817
[0m22:03:10.844995 [debug] [Thread-3  ]: On model.dbt_test.my_second_dbt_model: Close
[0m22:03:10.846204 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '739b9498-7802-46f9-8633-a7967dac5bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c90015b0>]}
[0m22:03:10.847229 [info ] [Thread-3  ]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.32s]
[0m22:03:10.848289 [debug] [Thread-3  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m22:03:10.850718 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:10.851426 [debug] [MainThread]: On master: BEGIN
[0m22:03:10.852008 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:03:10.859118 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:03:10.859901 [debug] [MainThread]: On master: COMMIT
[0m22:03:10.860550 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:10.861324 [debug] [MainThread]: On master: COMMIT
[0m22:03:10.862450 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:03:10.863323 [debug] [MainThread]: On master: Close
[0m22:03:10.865387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:10.866501 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m22:03:10.867637 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m22:03:10.868608 [info ] [MainThread]: 
[0m22:03:10.870066 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m22:03:10.871889 [debug] [MainThread]: Command end result
[0m22:03:10.887668 [info ] [MainThread]: 
[0m22:03:10.888482 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:03:10.889129 [info ] [MainThread]: 
[0m22:03:10.889810 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:03:10.891897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8167292, "process_user_time": 3.575325, "process_kernel_time": 0.32833, "process_mem_max_rss": "108662784", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:03:10.893346 [debug] [MainThread]: Command `dbt run` succeeded at 22:03:10.892987 after 1.82 seconds
[0m22:03:10.894393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c652a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c8f6d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c97bb3a0>]}
[0m22:03:10.895978 [debug] [MainThread]: Flushing usage events
[0m22:39:00.476933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb057629be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb059c84b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb059cc5a30>]}


============================== 22:39:00.482078 | f573bda0-0a82-4753-9683-aff06aca508a ==============================
[0m22:39:00.482078 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:39:00.482937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:39:00.483887 [info ] [MainThread]: dbt version: 1.7.11
[0m22:39:00.484476 [info ] [MainThread]: python version: 3.9.13
[0m22:39:00.485018 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m22:39:00.485552 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m22:39:00.611180 [info ] [MainThread]: Using profiles dir at /Users/amal/.dbt
[0m22:39:00.611985 [info ] [MainThread]: Using profiles.yml file at /Users/amal/.dbt/profiles.yml
[0m22:39:00.612797 [info ] [MainThread]: Using dbt_project.yml file at /Users/amal/Desktop/dbt/data_engineering/dbt_test/dbt_project.yml
[0m22:39:00.613785 [info ] [MainThread]: adapter type: postgres
[0m22:39:00.614424 [info ] [MainThread]: adapter version: 1.7.11
[0m22:39:00.720792 [info ] [MainThread]: Configuration:
[0m22:39:00.721589 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:39:00.722233 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:39:00.722770 [info ] [MainThread]: Required dependencies:
[0m22:39:00.723442 [debug] [MainThread]: Executing "git --help"
[0m22:39:00.740568 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:39:00.741906 [debug] [MainThread]: STDERR: "b''"
[0m22:39:00.742650 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:39:00.743316 [info ] [MainThread]: Connection:
[0m22:39:00.744044 [info ] [MainThread]:   host: localhost
[0m22:39:00.744616 [info ] [MainThread]:   port: 5432
[0m22:39:00.745169 [info ] [MainThread]:   user: amal
[0m22:39:00.745763 [info ] [MainThread]:   database: dbt_db
[0m22:39:00.746442 [info ] [MainThread]:   schema: public
[0m22:39:00.747615 [info ] [MainThread]:   connect_timeout: 10
[0m22:39:00.748963 [info ] [MainThread]:   role: None
[0m22:39:00.750329 [info ] [MainThread]:   search_path: None
[0m22:39:00.751091 [info ] [MainThread]:   keepalives_idle: 0
[0m22:39:00.751697 [info ] [MainThread]:   sslmode: None
[0m22:39:00.752261 [info ] [MainThread]:   sslcert: None
[0m22:39:00.752821 [info ] [MainThread]:   sslkey: None
[0m22:39:00.753382 [info ] [MainThread]:   sslrootcert: None
[0m22:39:00.753953 [info ] [MainThread]:   application_name: dbt
[0m22:39:00.754594 [info ] [MainThread]:   retries: 1
[0m22:39:00.755517 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m22:39:00.762542 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:39:00.765807 [debug] [MainThread]: Using postgres connection "debug"
[0m22:39:00.766870 [debug] [MainThread]: On debug: select 1 as id
[0m22:39:00.767749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:39:00.821405 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:39:00.824034 [debug] [MainThread]: On debug: Close
[0m22:39:00.825003 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:39:00.825828 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:39:00.828394 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.42555088, "process_user_time": 2.797318, "process_kernel_time": 0.421604, "process_mem_max_rss": "95526912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:39:00.829603 [debug] [MainThread]: Command `dbt debug` succeeded at 22:39:00.829328 after 0.43 seconds
[0m22:39:00.830358 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:39:00.831129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb057629be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb059dfaa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb059ea48e0>]}
[0m22:39:00.831995 [debug] [MainThread]: Flushing usage events
[0m22:39:11.016298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58e82ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59047e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5904a7220>]}


============================== 22:39:11.020930 | 9aade126-a79a-4baf-8d22-244d89c76fa0 ==============================
[0m22:39:11.020930 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:39:11.021771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amal/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amal/Desktop/dbt/data_engineering/dbt_test/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:39:11.495934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9aade126-a79a-4baf-8d22-244d89c76fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58ef82d30>]}
[0m22:39:11.601365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9aade126-a79a-4baf-8d22-244d89c76fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59067fa30>]}
[0m22:39:11.602356 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m22:39:11.631266 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:39:11.681990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:39:11.682777 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/example/users_model.sql
[0m22:39:11.856397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9aade126-a79a-4baf-8d22-244d89c76fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb590c240d0>]}
[0m22:39:11.876713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9aade126-a79a-4baf-8d22-244d89c76fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb590ab2d60>]}
[0m22:39:11.877525 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m22:39:11.878176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9aade126-a79a-4baf-8d22-244d89c76fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb590ab2ca0>]}
[0m22:39:11.881049 [info ] [MainThread]: 
[0m22:39:11.882300 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:39:11.884029 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m22:39:11.900924 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m22:39:11.901685 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m22:39:11.902272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:11.924854 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m22:39:11.927117 [debug] [ThreadPool]: On list_dbt_db: Close
[0m22:39:11.930220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m22:39:11.939911 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m22:39:11.940625 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m22:39:11.941185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:39:11.950077 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:39:11.950786 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m22:39:11.951400 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:39:11.955935 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:39:11.957776 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m22:39:11.958505 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m22:39:11.965504 [debug] [MainThread]: Using postgres connection "master"
[0m22:39:11.966189 [debug] [MainThread]: On master: BEGIN
[0m22:39:11.966725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:39:11.972657 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:39:11.973288 [debug] [MainThread]: Using postgres connection "master"
[0m22:39:11.973919 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:39:11.984009 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:39:11.986016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9aade126-a79a-4baf-8d22-244d89c76fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb590ce77c0>]}
[0m22:39:11.986683 [debug] [MainThread]: On master: ROLLBACK
[0m22:39:11.987327 [debug] [MainThread]: Using postgres connection "master"
[0m22:39:11.987828 [debug] [MainThread]: On master: BEGIN
[0m22:39:11.988591 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:39:11.989121 [debug] [MainThread]: On master: COMMIT
[0m22:39:11.989605 [debug] [MainThread]: Using postgres connection "master"
[0m22:39:11.990078 [debug] [MainThread]: On master: COMMIT
[0m22:39:11.990642 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:39:11.991136 [debug] [MainThread]: On master: Close
[0m22:39:11.992114 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:39:11.992790 [info ] [MainThread]: 
[0m22:39:11.998850 [debug] [Thread-1  ]: Began running node model.dbt_test.my_first_dbt_model
[0m22:39:11.999640 [debug] [Thread-2  ]: Began running node model.dbt_test.users_model
[0m22:39:12.000533 [info ] [Thread-1  ]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m22:39:12.001449 [info ] [Thread-2  ]: 2 of 3 START sql view model public.users_model ................................. [RUN]
[0m22:39:12.002613 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.dbt_test.my_first_dbt_model)
[0m22:39:12.003679 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.dbt_test.users_model'
[0m22:39:12.004504 [debug] [Thread-1  ]: Began compiling node model.dbt_test.my_first_dbt_model
[0m22:39:12.005215 [debug] [Thread-2  ]: Began compiling node model.dbt_test.users_model
[0m22:39:12.019347 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m22:39:12.022579 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_test.users_model"
[0m22:39:12.023988 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (compile): 22:39:12.005684 => 22:39:12.023558
[0m22:39:12.024847 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (compile): 22:39:12.019959 => 22:39:12.024450
[0m22:39:12.025503 [debug] [Thread-1  ]: Began executing node model.dbt_test.my_first_dbt_model
[0m22:39:12.026232 [debug] [Thread-2  ]: Began executing node model.dbt_test.users_model
[0m22:39:12.119662 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_test.users_model"
[0m22:39:12.121622 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m22:39:12.122734 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m22:39:12.123337 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m22:39:12.123840 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m22:39:12.124427 [debug] [Thread-2  ]: On model.dbt_test.users_model: BEGIN
[0m22:39:12.124966 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:39:12.125501 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:39:12.133555 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m22:39:12.134208 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m22:39:12.134815 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m22:39:12.135366 [debug] [Thread-2  ]: Using postgres connection "model.dbt_test.users_model"
[0m22:39:12.135949 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m22:39:12.136543 [debug] [Thread-2  ]: On model.dbt_test.users_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.users_model"} */

  create view "dbt_db"."public"."users_model__dbt_tmp"
    
    
  as (
    select id, user_name from users
  );
[0m22:39:12.137772 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 7:     select id, user_name from users
                                      ^

[0m22:39:12.138546 [debug] [Thread-2  ]: On model.dbt_test.users_model: ROLLBACK
[0m22:39:12.139478 [debug] [Thread-2  ]: Timing info for model.dbt_test.users_model (execute): 22:39:12.045328 => 22:39:12.139160
[0m22:39:12.140041 [debug] [Thread-2  ]: On model.dbt_test.users_model: Close
[0m22:39:12.143006 [debug] [Thread-2  ]: Database Error in model users_model (models/example/users_model.sql)
  relation "users" does not exist
  LINE 7:     select id, user_name from users
                                        ^
  compiled Code at target/run/dbt_test/models/example/users_model.sql
[0m22:39:12.143725 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aade126-a79a-4baf-8d22-244d89c76fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb590ca4490>]}
[0m22:39:12.144579 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model public.users_model ........................ [[31mERROR[0m in 0.14s]
[0m22:39:12.145485 [debug] [Thread-2  ]: Finished running node model.dbt_test.users_model
[0m22:39:12.180359 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m22:39:12.192501 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m22:39:12.193411 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m22:39:12.194672 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:39:12.200295 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m22:39:12.201068 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m22:39:12.202263 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:39:12.230751 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m22:39:12.231461 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m22:39:12.232060 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m22:39:12.233935 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m22:39:12.242814 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."my_first_dbt_model__dbt_backup"
[0m22:39:12.248326 [debug] [Thread-1  ]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m22:39:12.249125 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m22:39:12.257488 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m22:39:12.259960 [debug] [Thread-1  ]: Timing info for model.dbt_test.my_first_dbt_model (execute): 22:39:12.026716 => 22:39:12.259598
[0m22:39:12.260633 [debug] [Thread-1  ]: On model.dbt_test.my_first_dbt_model: Close
[0m22:39:12.261738 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aade126-a79a-4baf-8d22-244d89c76fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb590d2af70>]}
[0m22:39:12.262644 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.26s]
[0m22:39:12.263740 [debug] [Thread-1  ]: Finished running node model.dbt_test.my_first_dbt_model
[0m22:39:12.264804 [debug] [Thread-4  ]: Began running node model.dbt_test.my_second_dbt_model
[0m22:39:12.265938 [info ] [Thread-4  ]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m22:39:12.267302 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.dbt_test.my_second_dbt_model'
[0m22:39:12.267994 [debug] [Thread-4  ]: Began compiling node model.dbt_test.my_second_dbt_model
[0m22:39:12.274537 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m22:39:12.276201 [debug] [Thread-4  ]: Timing info for model.dbt_test.my_second_dbt_model (compile): 22:39:12.268419 => 22:39:12.275576
[0m22:39:12.277135 [debug] [Thread-4  ]: Began executing node model.dbt_test.my_second_dbt_model
[0m22:39:12.286784 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m22:39:12.288028 [debug] [Thread-4  ]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m22:39:12.288739 [debug] [Thread-4  ]: On model.dbt_test.my_second_dbt_model: BEGIN
[0m22:39:12.289390 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:39:12.297938 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m22:39:12.298845 [debug] [Thread-4  ]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m22:39:12.299707 [debug] [Thread-4  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dbt_db"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m22:39:12.344644 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:39:12.350844 [debug] [Thread-4  ]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m22:39:12.351653 [debug] [Thread-4  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dbt_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m22:39:12.352811 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:39:12.355964 [debug] [Thread-4  ]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m22:39:12.356823 [debug] [Thread-4  ]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m22:39:12.357585 [debug] [Thread-4  ]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m22:39:12.360171 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m22:39:12.366018 [debug] [Thread-4  ]: Applying DROP to: "dbt_db"."public"."my_second_dbt_model__dbt_backup"
[0m22:39:12.371207 [debug] [Thread-4  ]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m22:39:12.372077 [debug] [Thread-4  ]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dbt_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m22:39:12.373108 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m22:39:12.375686 [debug] [Thread-4  ]: Timing info for model.dbt_test.my_second_dbt_model (execute): 22:39:12.277771 => 22:39:12.375281
[0m22:39:12.376741 [debug] [Thread-4  ]: On model.dbt_test.my_second_dbt_model: Close
[0m22:39:12.378563 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aade126-a79a-4baf-8d22-244d89c76fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb590cc4be0>]}
[0m22:39:12.380173 [info ] [Thread-4  ]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.11s]
[0m22:39:12.381610 [debug] [Thread-4  ]: Finished running node model.dbt_test.my_second_dbt_model
[0m22:39:12.383882 [debug] [MainThread]: Using postgres connection "master"
[0m22:39:12.384563 [debug] [MainThread]: On master: BEGIN
[0m22:39:12.385156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:39:12.393285 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:39:12.394876 [debug] [MainThread]: On master: COMMIT
[0m22:39:12.396962 [debug] [MainThread]: Using postgres connection "master"
[0m22:39:12.398424 [debug] [MainThread]: On master: COMMIT
[0m22:39:12.399509 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:39:12.400295 [debug] [MainThread]: On master: Close
[0m22:39:12.401974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:39:12.402880 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m22:39:12.403576 [debug] [MainThread]: Connection 'model.dbt_test.users_model' was properly closed.
[0m22:39:12.404272 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m22:39:12.405018 [info ] [MainThread]: 
[0m22:39:12.405828 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m22:39:12.408037 [debug] [MainThread]: Command end result
[0m22:39:12.426977 [info ] [MainThread]: 
[0m22:39:12.428346 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:39:12.429543 [info ] [MainThread]: 
[0m22:39:12.430849 [error] [MainThread]:   Database Error in model users_model (models/example/users_model.sql)
  relation "users" does not exist
  LINE 7:     select id, user_name from users
                                        ^
  compiled Code at target/run/dbt_test/models/example/users_model.sql
[0m22:39:12.431758 [info ] [MainThread]: 
[0m22:39:12.432992 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:39:12.435385 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4839768, "process_user_time": 3.30744, "process_kernel_time": 0.357418, "process_mem_max_rss": "107876352", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:39:12.436664 [debug] [MainThread]: Command `dbt run` failed at 22:39:12.436379 after 1.49 seconds
[0m22:39:12.437559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58e82ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb590ab2d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59067fa30>]}
[0m22:39:12.438497 [debug] [MainThread]: Flushing usage events
